<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cap Embroidery Pricing | Northwest Custom Apparel</title>
    <link rel="stylesheet" href="/shared_components/css/shared-pricing-styles.css">
    <link rel="stylesheet" href="/shared_components/css/modern-enhancements.css">
    <link rel="stylesheet" href="/shared_components/css/universal-pricing-layout.css">
    <link rel="stylesheet" href="/shared_components/css/universal-pricing-components.css">
    <link rel="stylesheet" href="/shared_components/css/cap-embroidery-specific.css">
    <link rel="stylesheet" href="/shared_components/css/universal-header.css">
    <link rel="stylesheet" href="/shared_components/css/quantity-shortcuts.css">
    <link rel="stylesheet" href="/shared_components/css/mobile-collapsible-menu.css">
    <!-- Removed clean-color-swatches.css - using default dp5-helper styles -->
    <link rel="stylesheet" href="/shared_components/css/enhanced-loading-animations.css">
    <link rel="stylesheet" href="/shared_components/css/auto-save-quote.css">
    <link rel="stylesheet" href="/shared_components/css/hero-pricing-emphasis.css">
    <link rel="stylesheet" href="/shared_components/css/keyboard-navigation.css">
    <link rel="stylesheet" href="/shared_components/css/quote-system.css">
    <link rel="stylesheet" href="/shared_components/css/quote-system-api.css">
    <!-- Replaced with simple dropdown: <link rel="stylesheet" href="/shared_components/css/quote-system-enhanced.css"> -->
    <link rel="stylesheet" href="/shared_components/css/quote-dropdown-simple.css">
    <link rel="stylesheet" href="/shared_components/css/color-matrix.css">
    <link rel="stylesheet" href="/shared_components/css/cumulative-quote.css">
    <link rel="stylesheet" href="/shared_components/css/cumulative-quote-fix.css">
    <link rel="stylesheet" href="/shared_components/css/hero-pricing-breakdown.css">
    <link rel="stylesheet" href="/shared_components/css/cap-embroidery-back-logo-fix.css">
    <link rel="stylesheet" href="/shared_components/css/hero-pricing-clean-layout.css">
    
<!-- jsPDF Libraries for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <!-- Universal Navigation Header -->
    <header class="universal-header">
        <!-- Top Bar with Company Info -->
        <div class="header-top-bar">
            <div class="header-top-bar-content">
                <div class="contact-info">
                    <span>üìû 253-922-5793</span>
                    <span>‚úâÔ∏è sales@nwcustomapparel.com</span>
                    <span>üïí 9AM-5PM</span>
                </div>
                <div class="header-actions">
                    <button onclick="window.print()" class="header-action-btn">
                        üñ®Ô∏è Print Quote
                    </button>
                    <button onclick="shareQuote()" class="header-action-btn">
                        üì§ Share
                    </button>
                    <button onclick="toggleHelp()" class="header-action-btn">
                        ‚ùì Help
                    </button>
                    <!-- Quote dropdown will be injected here by JS -->
                </div>
            </div>
        </div>
        
        <!-- Main Header Navigation -->
        <div class="header-main">
            <div class="header-main-content">
                
                <!-- Logo & Company Brand -->
                <div class="header-brand">
                    <img src="https://cdn.caspio.com/A0E15000/Safety%20Stripes/NWCA%20White%20Text.png?ver=1" alt="NW Custom Apparel Logo" class="header-logo-img">
                </div>
                
                <!-- Navigation & Search Hub -->
                <div class="header-nav-hub">
                    
                    <!-- Back to Product Button -->
                    <a id="back-to-product" href="#" class="back-to-product">
                        <span class="back-icon">‚Üê</span> 
                        <span>Back to Product</span>
                    </a>
                    
                    <!-- Style Search -->
                    <div class="style-search-container">
                        <div class="style-search-input-wrapper">
                            <span class="style-search-icon">üîç</span>
                            <input type="text" id="style-search-input" placeholder="Search style (e.g., PC61)" autocomplete="off" class="style-search-input">
                        </div>
                        <div id="style-search-results" class="style-search-results"></div>
                    </div>
                    
                    <!-- Page Context Indicator -->
                    <div class="page-context">
                        <div class="page-context-title">Cap Embroidery Pricing</div>
                        <div class="page-context-subtitle" id="current-product-context">Select a product to get started</div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="header-quick-actions">
                    
                    <!-- Quick Quote Toggle -->
                    <button onclick="toggleQuickQuote()" class="quick-action-btn">
                        üìä Quote
                    </button>
                    
                    <!-- Sample Request -->
                    <button onclick="requestSample()" class="quick-action-btn">
                        üßµ Sample
                    </button>
                    
                    <!-- Contact for Quote -->
                    <button onclick="contactForQuote()" class="primary-action-btn">
                        üí¨ Get Quote
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb Navigation -->
        <div class="header-breadcrumb">
            <div class="header-breadcrumb-content">
                <nav class="header-breadcrumb-nav">
                    <a href="javascript:void(0)" onclick="goToHome()" class="breadcrumb-link" title="Go to home page">Home</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Products</span>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a id="breadcrumb-product-link" href="#" class="breadcrumb-link">
                        <span id="breadcrumb-product">Product</span>
                    </a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span class="breadcrumb-current">Cap Embroidery Pricing</span>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Removed the old h1 since we have it in the header now -->

        <!-- Compact Quick Quote Section -->
        <div class="quick-quote-banner">
            <div>
                <h3 class="quick-quote-title">Quick Quote Calculator</h3>
                <p class="quick-quote-subtitle">Enter quantity for instant pricing</p>
            </div>
            
            <div class="quick-quote-controls">
                <button id="hero-quantity-decrease" type="button" class="hero-quantity-btn" aria-label="Decrease quantity" aria-controls="hero-quantity-input">‚àí</button>
                
                <input id="hero-quantity-input" type="number" min="1" max="10000" value="24" class="hero-quantity-input" 
                       aria-label="Quantity of caps" 
                       aria-describedby="hero-total-price hero-ltm-warning"
                       role="spinbutton"
                       aria-valuemin="1"
                       aria-valuemax="10000"
                       aria-valuenow="24">
                
                <button id="hero-quantity-increase" type="button" class="hero-quantity-btn" aria-label="Increase quantity" aria-controls="hero-quantity-input">+</button>
                
                <span class="quantity-label" id="quantity-label-text">caps</span>
            </div>
            
            <div class="quick-quote-pricing">
                <div id="hero-unit-price" class="hero-unit-price hero-price-primary">
                    <span class="hero-price-amount">$12.50</span>
                    <span class="hero-price-label">per cap</span>
                </div>
                <div id="hero-total-price" class="hero-total-price hero-price-secondary">
                    <span class="hero-price-prefix">Total:</span> $625.00
                </div>
                <div id="hero-pricing-breakdown" class="hero-pricing-breakdown" style="margin-top: 10px; font-size: 0.85em; color: #666; line-height: 1.4;">
                    <div>Front logo (<span id="hero-stitch-count">8,000</span> stitches): $<span id="hero-base-price">12.50</span></div>
                    <div id="hero-back-logo-line" style="display: none;">Back logo: +$<span id="hero-back-logo-price">5.00</span></div>
                    <div id="hero-setup-fee-line" style="display: none;">Setup fee (per cap): +$<span id="hero-setup-fee">0.00</span></div>
                    <div style="margin-top: 5px; padding-top: 5px; border-top: 1px solid #ddd;">
                        <strong>Total per cap: $<span id="hero-total-per-cap">12.50</span></strong>
                    </div>
                </div>
                <div class="hero-pricing-note">Pricing based on 8,000 stitches</div>
            </div>
        </div>
        
        <!-- Quantity Shortcuts -->
        <div id="quantity-shortcuts-container"></div>
        
        <!-- Compact notifications -->
        <div id="hero-optimization-tip" class="hero-optimization-tip">
            üí° <span id="optimization-message">Add 22 more caps for better pricing!</span>
        </div>
        
        <div id="hero-ltm-warning" class="hero-ltm-warning">
            ‚ö†Ô∏è <span id="ltm-message">Orders under 24 caps include a $50 setup fee</span>
        </div>


        <!-- Modern Branded Layout -->
        <div class="main-content-wrapper">
            
            <!-- Hidden Caspio Matrix - Keep this for data source -->
            <div id="pricing-calculator" class="pricing-calculator hidden-calculator">
                <div class="loading-message">Loading pricing data...</div>
            </div>
            
            <!-- Product Information Card -->
            <div class="content-card" id="product-info">
                <div class="card-header">
                    <h2 class="large">Product Information</h2>
                    <div class="card-header-content">
                        <div>
                            <h3 id="product-title-context" class="product-title">Product Title</h3>
                            <div class="product-context-info">
                                Style: <strong id="product-style-context">Style Number</strong>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card-content card-grid">
                    <!-- Product Image -->
                    <div>
                        <div id="product-image-gallery" class="image-gallery-enhanced">
                            <div id="main-image-container" class="image-container-enhanced">
                                <img id="product-image-main" src="" alt="Product Image" class="product-main-image" 
                                     onerror="this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgZmlsbD0iI2Y4ZjlmYSIvPjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjIwMCIgeT0iMjAwIiBmaWxsPSIjNmM3NTdkIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiPkltYWdlIE5vdCBBdmFpbGFibGU8L3RleHQ+PC9zdmc+'; this.alt='Image not available';">
                                <div class="image-loading-spinner"></div>
                                <div class="image-zoom-overlay zoom-overlay-enhanced">üîç</div>
                            </div>
                            <div id="image-thumbnails" class="image-thumbnails-enhanced">
                                <!-- Thumbnails will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Product Details & Colors -->
                    <div class="product-details-section">
                        <div class="info-panel">
                            <h4>What's Included</h4>
                            <p>Pricing includes an 8,000 stitch embroidered logo on one location.</p>
                        </div>
                        
                        <!-- Color Selection -->
                        <div class="color-selection-section">
                            <h4 class="section-header">
                                Select Color
                                <button class="btn-secondary" style="float: right; font-size: 14px;" onclick="capEmbroideryController.openColorMatrix()">
                                    + Add Multiple Colors
                                </button>
                            </h4>
                            
                            <!-- Color Swatches Grid -->
                            <div id="color-swatches" class="color-grid">
                                <!-- Color swatches will be dynamically added here by dp5-helper -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Customization Options Card -->
            <div class="content-card" id="customization">
                <div class="card-header">
                    <h2>Customization Options</h2>
                    <p>Adjust your embroidery details (updates pricing above)</p>
                </div>
                
                <div class="card-content card-grid">
                    <!-- Stitch Count Selection -->
                    <div class="form-section">
                        <h3>Front Logo Stitch Count</h3>
                        <div style="margin-bottom: 15px;">
                            <select id="client-stitch-count-select" name="client-stitch-count-select" class="stitch-count-select"
                                    aria-label="Front logo stitch count"
                                    aria-describedby="stitch-count-note">
                                <option value="5000">5,000 stitches</option>
                                <option value="8000" selected>8,000 stitches (Standard)</option>
                                <option value="10000">10,000 stitches</option>
                            </select>
                            <span id="stitch-count-indicator" class="form-feedback" role="status" aria-live="polite">‚úì Quick quote updated!</span>
                        </div>
                        <div class="form-note">
                            Higher stitch counts allow for more detailed designs but may increase cost.
                        </div>
                    </div>
                    
                    <!-- Back Logo Option -->
                    <div class="form-section">
                        <h3>Back Logo Embroidery</h3>
                        <div style="margin-bottom: 15px;">
                            <label class="back-logo-checkbox-container" for="back-logo-checkbox">
                                <input type="checkbox" id="back-logo-checkbox" class="back-logo-checkbox"
                                       aria-describedby="back-logo-note"
                                       aria-controls="back-logo-details">
                                Add embroidered back logo (+$5.00 per cap)
                            </label>
                        </div>
                        
                        <div id="back-logo-details" class="back-logo-details">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Stitch Count:</label>
                                <div class="stitch-counter" role="group" aria-label="Back logo stitch count">
                                    <button id="back-logo-decrement" type="button" class="stitch-counter-btn" 
                                            aria-label="Decrease back logo stitch count"
                                            aria-controls="back-logo-stitch-display">‚àí</button>
                                    
                                    <span id="back-logo-stitch-display" class="stitch-counter-display" 
                                          role="status" 
                                          aria-live="polite"
                                          aria-label="Current back logo stitch count">5,000</span>
                                    
                                    <button id="back-logo-increment" type="button" class="stitch-counter-btn"
                                            aria-label="Increase back logo stitch count"
                                            aria-controls="back-logo-stitch-display">+</button>
                                    
                                    <span class="stitch-counter-range" aria-label="Stitch count range">(5K-15K)</span>
                                </div>
                            </div>
                            
                            <div class="cost-display">
                                <strong id="back-logo-price">Additional Cost: $5.00 per cap</strong>
                            </div>
                        </div>
                        
                        <div class="form-note">
                            Optional upgrade for branding on both sides of the cap.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pricing Table Card -->
            <div class="content-card" id="pricing-details">
                <div class="card-header">
                    <h2>Detailed Pricing by Quantity</h2>
                    <p>Volume discounts automatically applied</p>
                </div>
                
                <div class="card-content">
                    <div class="pricing-table-container">
                        <table id="custom-pricing-grid" class="pricing-table">
                            <thead>
                                <tr id="pricing-header-row" class="pricing-table-header">
                                    <th>Quantity Range</th>
                                    <!-- Size headers will be dynamically populated -->
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Pricing data will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="card-note">
                        <p>
                            <strong>Note:</strong> Prices shown include embroidered logo on front. Back logo and setup fees calculated separately.
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Quote Builder Section -->
            <div id="quote-builder" class="content-card quote-builder-section">
                <div id="add-to-cart-section">
                    <!-- Quote adapter will inject content here -->
                    <!-- This container exists to satisfy the quote adapter's expectations -->
                </div>
                
                <!-- Debug button for testing sidebar -->
                <div style="margin-top: 20px; text-align: center;">
                    <button onclick="if(window.capEmbroideryQuoteAdapter) { window.capEmbroideryQuoteAdapter.displayQuoteSummary(); console.log('Manually triggered sidebar display'); } else { console.error('Quote adapter not found'); }" 
                            style="background: #ff6b6b; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">
                        üîß Debug: Show Quote Sidebar
                    </button>
                </div>
            </div>
            
            <!-- Removed floating button - using header dropdown instead -->
            
            <!-- Call to Action Card -->
            <div class="cta-card">
                <h2 class="cta-title">Ready for Your Quote?</h2>
                <p class="cta-subtitle">
                    Contact us with your quantity and customization details for a personalized quote.
                </p>
                
                <div class="cta-buttons">
                    <button class="cta-btn-primary">
                        üìû Call for Quote: 253-922-5793
                    </button>
                    
                    <button class="cta-btn-secondary">
                        ‚úâÔ∏è Email Quote Request
                    </button>
                </div>
                
                <div class="cta-features">
                    <p>üíö <strong>Why Choose Northwest Custom Apparel?</strong></p>
                    <p>Family Owned and Operated Since 1977 ‚Ä¢ Milton, WA ‚Ä¢ Quality embroidery</p>
                    <p>üìç 2025 Freeman Road East Milton, WA 98354</p>
                    <p>üì± You can text us at 253-922-5793</p>
                </div>
            </div>
        </div>
    </div> <!-- End .container -->
    
    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-grid">
                
                <!-- Company Info -->
                <div class="footer-column">
                    <h3>Northwest Custom Apparel</h3>
                    <p class="tagline">Family Owned and Operated Since 1977</p>
                    <p class="address">üìç 2025 Freeman Road East</p>
                    <p class="address">Milton, WA 98354</p>
                </div>
                
                <!-- Contact Info -->
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <p>üìû Call: <a href="tel:253-922-5793" class="footer-link">253-922-5793</a></p>
                    <p>üì± Text: <a href="sms:253-922-5793" class="footer-link">253-922-5793</a></p>
                    <p>‚úâÔ∏è Email: <a href="mailto:sales@nwcustomapparel.com" class="footer-link">sales@nwcustomapparel.com</a></p>
                    <p>üïí Hours: 9AM-5PM</p>
                </div>
                
                <!-- Quote Requests -->
                <div class="footer-column">
                    <h3>Request a Quote</h3>
                    <p class="tagline">Send quote requests to:</p>
                    <p>‚úâÔ∏è <a href="mailto:sales@nwcustomapparel.com?subject=Cap Embroidery Quote Request" class="footer-link underlined">sales@nwcustomapparel.com</a></p>
                    <p class="footer-quote-note">Include: quantity, design details, and deadline</p>
                </div>
            </div>
            
            <!-- Copyright -->
            <div class="footer-copyright">
                <p>&copy; 2025 Northwest Custom Apparel. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript Files -->
    <!-- Base Layer - Core dependencies -->
    <script src="/shared_components/js/debug-config.js"></script> <!-- Debug configuration - MUST LOAD FIRST -->
    <script src="/shared_components/js/nwca-namespace.js"></script> <!-- NWCA Global Namespace -->
    <script src="/shared_components/js/constants.js"></script> <!-- Global constants -->
    <script src="/shared_components/js/app-config.js"></script> <!-- Application configuration -->
    <script src="/shared_components/js/utils.js"></script> <!-- General utility functions -->
    
    <!-- Data Layer - Pricing system -->
    <script src="/shared_components/js/pricing-matrix-api.js"></script> <!-- API communication -->
    <script src="/shared_components/js/pricing-matrix-capture.js"></script> <!-- Captures pricing from Caspio -->
    <script src="/shared_components/js/pricing-calculator.js"></script> <!-- Core pricing calculations -->
    <script src="/shared_components/js/dp5-helper.js"></script> <!-- DP5 integration helper -->
    
    <!-- Quote System Base -->
    <script src="/shared_components/js/quote-api-client.js"></script> <!-- Quote API client -->
    <script src="/shared_components/js/base-quote-system.js"></script> <!-- Base quote system with cumulative pricing -->
    <script src="/shared_components/js/quote-adapter-base.js"></script> <!-- Base class for quote adapters -->
    
    <!-- UI Foundation -->
    <script src="/shared_components/js/ui-components.js"></script> <!-- UI components for loading/error states -->
    <script src="/shared_components/js/pricing-pages.js"></script> <!-- Common pricing page functionality -->
    
    <!-- Hero Section & Product UI -->
    <script src="/shared_components/js/hero-quantity-calculator.js"></script> <!-- Hero quantity calculator -->
    <script src="/shared_components/js/hero-pricing-updater.js"></script> <!-- Hero pricing display -->
    <script src="/shared_components/js/product-quantity-ui.js"></script> <!-- Quantity UI components -->
    <script src="/shared_components/js/product-pricing-ui.js"></script> <!-- Product pricing UI -->
    
    <!-- Cap Embroidery Specific - Load after dependencies -->
    <script src="/shared_components/js/cap-embroidery-controller-v2.js"></script> <!-- Main controller (depends on NWCA, pricing) -->
    <script src="/shared_components/js/cap-embroidery-back-logo.js"></script> <!-- Back logo functionality -->
    <script src="/shared_components/js/cap-embroidery-hero-breakdown.js"></script> <!-- Hero pricing breakdown -->
    <script src="/shared_components/js/cap-embroidery-validation.js"></script> <!-- Validation utilities -->
    <script src="/shared_components/js/cap-embroidery-quote-adapter.js?v=2.1"></script> <!-- Quote adapter (depends on base) - v2.1 with size handling fix -->
    
    <!-- Additional Features -->
    <!-- Replaced with simple dropdown: <script src="/shared_components/js/quote-system-manager.js"></script> -->
    <script src="/shared_components/js/quote-dropdown-simple.js"></script> <!-- Simple quote dropdown -->
    <script src="/shared_components/js/color-matrix-manager.js"></script> <!-- Color matrix manager -->
    <script src="/shared_components/js/universal-header.js"></script> <!-- Universal header functionality -->
    <script src="/shared_components/js/header-button-functions.js"></script> <!-- Header button implementations -->
    <script src="/shared_components/js/order-form-pdf.js"></script> <!-- PDF generation -->
    <script src="/shared_components/js/quantity-shortcuts.js"></script> <!-- Quick quantity shortcuts -->
    <script src="/shared_components/js/mobile-collapsible-ultimate-fix.js"></script> <!-- Mobile accordion -->
    <!-- Removed clean-color-adapter.js - dp5-helper.js already handles color swatches -->
    <script src="/shared_components/js/enhanced-loading-animations.js"></script> <!-- Loading animations -->
    <script src="/shared_components/js/auto-save-quote.js"></script> <!-- Auto-save quote draft -->
    <script src="/shared_components/js/keyboard-navigation.js"></script> <!-- Keyboard navigation support -->
    <script src="/shared_components/js/cap-embroidery-back-logo-complete-fix.js"></script> <!-- Complete fix for back logo stitch count with confirmation -->
    <script src="/shared_components/js/hero-pricing-clean-breakdown.js"></script> <!-- Clean non-redundant pricing breakdown -->
    <script src="/shared_components/js/cap-embroidery-ltm-fix.js"></script> <!-- LTM pricing fix - MUST LOAD LAST -->
    
</body>
</html>