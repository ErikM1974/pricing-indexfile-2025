<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Contract Embroidery Pricing Calculator - Northwest Custom Apparel</title>
    <link rel="icon" href="https://cdn.caspio.com/A0E15000/Safety%20Stripes/NWCA%20Favicon%20for%20TEAMNWCA.com.png?ver=1" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <!-- Shared Calculator Styles -->
    <link href="../shared_components/css/calculator-base.css" rel="stylesheet">
    
    <!-- Embroidery-Specific Styles -->
    <link href="embroidery-contract-styles.css" rel="stylesheet">
    
    <!-- Embroidery Contract Fix CSS - Enhances NWCA green theme and improves visual design -->
    <link href="embroidery-contract-fix.css" rel="stylesheet">
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    
    <!-- Base Quote Service -->
    <script src="../shared_components/js/base-quote-service.js"></script>
    <!-- Calculator Utilities -->
    <script src="../shared_components/js/calculator-utilities.js"></script>
    <!-- Embroidery Quote Service -->
    <script src="embroidery-quote-service.js"></script>
    <!-- Embroidery Calculator Class -->
    <script src="embroidery-contract-calculator.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="header-left">
                <img src="https://cdn.caspio.com/A0E15000/Safety%20Stripes/web%20northwest%20custom%20apparel%20logo.png?ver=1" alt="Northwest Custom Apparel" class="logo">
                <nav class="breadcrumb">
                    <a href="/staff-dashboard.html">Dashboard</a>
                    <span>/</span>
                    <span>Contract Embroidery</span>
                </nav>
            </div>
            <div class="user-welcome">
                Contract Embroidery Calculator
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <div class="page-header">
            <div>
                <h1 class="page-title">
                    <i class="fas fa-sewing-needle title-icon"></i>
                    Contract Embroidery Pricing
                </h1>
                <p class="page-subtitle">Calculate pricing for flat embroidery and caps with stitch count based pricing</p>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="guide-button" onclick="openBuyersGuide()">
                    <i class="fas fa-book"></i>
                    Buyer's Guide
                </button>
                <button class="guide-button" onclick="openEmailGuideModal()">
                    <i class="fas fa-envelope"></i>
                    Email Guide
                </button>
            </div>
        </div>

        <div class="calculator-grid">
            <!-- Input Section -->
            <div class="input-section">
                <h2 class="section-title">
                    <i class="fas fa-calculator"></i>
                    Build Your Quote
                </h2>

                <form id="calculatorForm">
                    <!-- Customer Info -->
                    <div class="form-group">
                        <label class="form-label" for="customerName">Customer Name</label>
                        <input type="text" id="customerName" class="form-input" placeholder="Enter customer name">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="projectName">Project Name</label>
                        <input type="text" id="projectName" class="form-input" placeholder="Enter project name">
                    </div>

                    <!-- Product Type -->
                    <div class="form-group">
                        <label class="form-label" for="productType">Product Type</label>
                        <select id="productType" class="form-select" required>
                            <option value="">Select product type...</option>
                            <option value="Flat Embroidery">Flat Embroidery</option>
                            <option value="Caps">Caps</option>
                        </select>
                    </div>

                    <!-- Stitch Count -->
                    <div class="form-group">
                        <label class="form-label" for="stitchCount">Stitch Count</label>
                        <select id="stitchCount" class="form-select" required>
                            <option value="">Select stitch count...</option>
                            <option value="6,000">6,000 stitches</option>
                            <option value="7,000">7,000 stitches</option>
                            <option value="8,000">8,000 stitches</option>
                            <option value="9,000">9,000 stitches</option>
                            <option value="10,000">10,000 stitches</option>
                            <option value="11,000">11,000 stitches</option>
                            <option value="12,000">12,000 stitches</option>
                            <option value="13,000">13,000 stitches</option>
                            <option value="14,000">14,000 stitches</option>
                            <option value="15,000">15,000 stitches</option>
                            <option value="16,000">16,000 stitches</option>
                            <option value="17,000">17,000 stitches</option>
                            <option value="18,000">18,000 stitches</option>
                            <option value="19,000">19,000 stitches</option>
                            <option value="20,000">20,000 stitches</option>
                            <option value="21,000">21,000 stitches</option>
                            <option value="22,000">22,000 stitches</option>
                            <option value="23,000">23,000 stitches</option>
                            <option value="24,000">24,000 stitches</option>
                            <option value="25,000">25,000 stitches</option>
                        </select>
                    </div>

                    <!-- Quantity -->
                    <div class="form-group">
                        <label class="form-label" for="quantity">Quantity</label>
                        <input type="number" id="quantity" class="form-input" min="1" placeholder="Enter quantity" required>
                    </div>

                    <!-- Thread Colors -->
                    <div class="form-group">
                        <label class="form-label" for="threadColors">Number of Thread Colors</label>
                        <input type="number" id="threadColors" class="form-input" min="1" value="1" required>
                        <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">
                            First 4 colors included, $1.00 per additional color per item
                        </small>
                    </div>

                    <!-- Calculate Button -->
                    <button type="submit" class="btn btn-primary btn-fullwidth">
                        <i class="fas fa-calculator"></i>
                        Calculate Quote
                    </button>
                </form>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <div id="emptyState" class="empty-state">
                    <i class="fas fa-sewing-needle"></i>
                    <h3>Your embroidery quote will appear here</h3>
                    <p>Enter your project details and click calculate</p>
                </div>

                <div id="resultsDisplay" class="hidden">
                    <!-- Quote results will be displayed here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Quote Modal -->
    <div id="quoteModal" class="modal-backdrop">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Send Quote</h2>
                <button type="button" class="modal-close" id="modalClose">&times;</button>
            </div>

            <!-- Sales Rep Selection -->
            <div class="form-group">
                <label class="form-label" for="salesRep">Sales Representative</label>
                <select id="salesRep" class="form-select" required>
                    <option value="">Select a sales rep...</option>
                    <option value="ruth@nwcustomapparel.com" selected>Ruth</option>
                    <option value="taylar@nwcustomapparel.com">Taylar</option>
                    <option value="nika@nwcustomapparel.com">Nika</option>
                    <option value="erik@nwcustomapparel.com">Erik</option>
                    <option value="adriyella@nwcustomapparel.com">Adriyella</option>
                    <option value="sales@nwcustomapparel.com">General Sales</option>
                </select>
            </div>

            <form id="quoteForm">
                <div class="form-group">
                    <label class="form-label" for="quoteCustomerName">Customer Name</label>
                    <input type="text" id="quoteCustomerName" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="customerEmail">Customer Email</label>
                    <input type="email" id="customerEmail" class="form-input" required placeholder="customer@example.com">
                </div>

                <div class="form-group">
                    <label class="form-label" for="customerPhone">Phone Number (optional)</label>
                    <input type="tel" id="customerPhone" class="form-input" placeholder="(555) 123-4567">
                </div>

                <div class="form-group">
                    <label class="form-label" for="companyName">Company Name (optional)</label>
                    <input type="text" id="companyName" class="form-input">
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="saveToDatabase" checked>
                    <label for="saveToDatabase">Save quote to database</label>
                </div>

                <div id="quotePreview" class="quote-summary">
                    <!-- Quote preview will be shown here -->
                </div>

                <button type="submit" class="btn btn-success btn-fullwidth">
                    <i class="fas fa-paper-plane"></i>
                    Send Quote
                </button>
            </form>

            <div id="successMessage" class="success-message hidden">
                <i class="fas fa-check-circle"></i>
                <span>Quote sent successfully!</span>
            </div>

            <div id="errorMessage" class="error-message hidden">
                <i class="fas fa-exclamation-circle"></i>
                <span id="errorText">An error occurred. Please try again.</span>
            </div>
        </div>
    </div>

    <!-- Hidden print content -->
    <div id="printContent" style="display: none;"></div>

    <!-- Buyer's Guide Modal -->
    <div id="buyersGuideModal" class="guide-modal">
        <div class="guide-content">
            <div class="guide-header">
                <h2>Contract Embroidery FAQ & Order Guide</h2>
                <button class="guide-close" onclick="closeBuyersGuide()">&times;</button>
            </div>
            
            <div class="guide-tabs">
                <button class="guide-tab active" onclick="showGuideSection('guide-faq')">Frequently Asked Questions</button>
                <button class="guide-tab" onclick="showGuideSection('guide-order')">Order Placement Guide</button>
            </div>
            
            <div class="guide-body">
                <!-- FAQ Section -->
                <div id="guide-faq" class="guide-section active">
                    <div class="faq-category">
                        <h3>📋 General Questions</h3>
                        <div class="faq-item">
                            <div class="faq-question">What is your minimum order quantity?</div>
                            <div class="faq-answer">Our standard minimum order is $100. Orders below this minimum are subject to a $50.00 charge plus a 25% upcharge on the embroidery cost.</div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question">What is your standard turnaround time?</div>
                            <div class="faq-answer">We request 12-14 working days after all approvals are received, with a minimum of 3 days processing time after receiving the product. Rush orders (4-7 working days) incur a 25% surcharge.</div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question">What file formats do you accept for artwork?</div>
                            <div class="faq-answer">We accept JPEG (.jpg), PNG (.png), TIFF (.tiff), CorelDRAW (.cdr), and Adobe Illustrator (.ai). Vector files (.ai or .cdr) are preferred for optimal results.</div>
                        </div>
                    </div>

                    <div class="faq-category">
                        <h3>💰 Pricing Questions</h3>
                        <div class="faq-item">
                            <div class="faq-question">How is embroidery pricing calculated?</div>
                            <div class="faq-answer">Pricing is based on stitch count and quantity ordered. Additional charges apply for: designs over 4 thread colors ($1.00 per color), metallic thread (25% surcharge), bulky items (50% surcharge), and rush orders (25% surcharge).</div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question">What additional services do you offer?</div>
                            <div class="faq-answer">Product mock-ups ($35.00), minor edits ($35.00), personalization ($13.50), emblem sewing ($5.00 each), poly bagging ($0.45-$1.20), and drop shipping ($5.00 per box).</div>
                        </div>
                    </div>

                    <div class="faq-category">
                        <h3>🎯 Technical Questions</h3>
                        <div class="faq-item">
                            <div class="faq-question">What are the size limitations for cap embroidery?</div>
                            <div class="faq-answer">Standard cap front embroidery can be up to 5 inches wide and 2.25 inches in height, depending on the cap's structure and front panel shape.</div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question">What thread do you use?</div>
                            <div class="faq-answer">We exclusively use Robison Anton Rayon thread for its durability and vibrant color selection. We can closely match Pantone colors from our extensive inventory.</div>
                        </div>
                    </div>

                    <div class="faq-category">
                        <h3>💳 Payment & Shipping</h3>
                        <div class="faq-item">
                            <div class="faq-question">What payment methods do you accept?</div>
                            <div class="faq-answer">We accept net terms (with approved credit application), checks, cash, and Visa or Mastercard.</div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question">Where should I ship blank garments?</div>
                            <div class="faq-answer">Ship to: Northwest Custom Apparel, 2025 Freeman Road East, Milton, WA 98354</div>
                        </div>
                    </div>
                </div>

                <!-- Order Guide Section -->
                <div id="guide-order" class="guide-section">
                    <h3 style="color: var(--primary-color); margin-bottom: 2rem;">How to Place Your Order</h3>
                    
                    <div class="order-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Prepare Your Order Information</h4>
                            <ul>
                                <li>Company and contact details</li>
                                <li>Purchase order number</li>
                                <li>Due date and in-hands date</li>
                                <li>Artwork files (vector preferred)</li>
                                <li>Garment specifications</li>
                            </ul>
                        </div>
                    </div>

                    <div class="order-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Specify Decoration Details</h4>
                            <ul>
                                <li>Exact placement location</li>
                                <li>Design dimensions</li>
                                <li>Thread colors (from our chart)</li>
                                <li>Total stitch count</li>
                                <li>Digitizing company (if applicable)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="order-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Complete Purchase Order</h4>
                            <ul>
                                <li>Use our order checklist format</li>
                                <li>Include all required fields</li>
                                <li>Add special instructions if needed</li>
                                <li>Double-check all information</li>
                                <li>Save as PDF (required)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="order-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Submit Your Order</h4>
                            <ul>
                                <li>Email PDF to ruth@nwcustomapparel.com</li>
                                <li>Or call Ruthie at 253-922-5793, ext. 119</li>
                                <li>Wait for order and design approval</li>
                                <li>Ship garments 3+ days before production</li>
                            </ul>
                        </div>
                    </div>

                    <div class="guide-note">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Important:</strong> We do NOT accept orders typed in email body text. All orders must be submitted as PDF attachments using our order format to ensure accuracy and avoid delays.
                        </div>
                    </div>

                    <!-- Purchase Order Example -->
                    <h3 style="color: var(--primary-color); margin-top: 3rem; margin-bottom: 1.5rem;">Purchase Order Example</h3>
                    
                    <div class="po-example">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 2rem;">
                            <div>
                                <h4>PURCHASE ORDER #2025-001</h4>
                                <p style="color: var(--text-secondary);">Northwest Custom Apparel</p>
                            </div>
                            <div style="text-align: right;">
                                <p><strong>Date:</strong> June 26, 2025</p>
                                <p><strong>Due Date:</strong> July 10, 2025</p>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-bottom: 1rem;">1. Job Information</h4>
                        <div class="po-grid">
                            <div class="po-field">
                                <span class="po-label">Company Name</span>
                                <span class="po-value">ABC Corporation</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Contact Name</span>
                                <span class="po-value">John Smith</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Phone</span>
                                <span class="po-value">(555) 123-4567</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Email</span>
                                <span class="po-value">john@abccorp.com</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Job Name</span>
                                <span class="po-value">Summer Team Polos</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">In-hands Date</span>
                                <span class="po-value">July 8, 2025</span>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-top: 2rem; margin-bottom: 1rem;">2. Art Information</h4>
                        <div class="po-grid">
                            <div class="po-field">
                                <span class="po-label">Art Type</span>
                                <span class="po-value">✓ Repeat Order</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Mockup Needed?</span>
                                <span class="po-value">Yes</span>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-top: 2rem; margin-bottom: 1rem;">3. Garment Details</h4>
                        <div class="po-grid">
                            <div class="po-field">
                                <span class="po-label">Style #</span>
                                <span class="po-value">K500</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Color</span>
                                <span class="po-value">Navy Blue</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Description</span>
                                <span class="po-value">Port Authority Silk Touch Polo</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Quantity</span>
                                <span class="po-value">48 pieces</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Vendor</span>
                                <span class="po-value">SanMar</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Vendor PO#</span>
                                <span class="po-value">SM-789456</span>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-top: 2rem; margin-bottom: 1rem;">4. Decoration Details</h4>
                        <div class="po-grid">
                            <div class="po-field">
                                <span class="po-label">Location</span>
                                <span class="po-value">Left Chest</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Thread Colors</span>
                                <span class="po-value">White, Red, Blue</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Design #</span>
                                <span class="po-value">ABC-LOGO-2025</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Stitches</span>
                                <span class="po-value">8,500</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Size</span>
                                <span class="po-value">3.5" wide</span>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-top: 2rem; margin-bottom: 1rem;">5. Shipping Information</h4>
                        <div class="po-grid">
                            <div class="po-field">
                                <span class="po-label">Ship To</span>
                                <span class="po-value">ABC Corporation</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Address</span>
                                <span class="po-value">123 Main Street</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">City, State, ZIP</span>
                                <span class="po-value">Seattle, WA 98101</span>
                            </div>
                            <div class="po-field">
                                <span class="po-label">Ship Method</span>
                                <span class="po-value">UPS Ground</span>
                            </div>
                        </div>

                        <h4 style="color: var(--primary-color); margin-top: 2rem; margin-bottom: 1rem;">6. Special Notes</h4>
                        <div class="po-value" style="width: 100%; min-height: 60px;">
                            Please ensure consistent placement across all sizes. Pack by size for easy distribution.
                        </div>
                    </div>

                    <!-- Contact Cards -->
                    <div class="contact-cards">
                        <div class="contact-card">
                            <h4>📧 Submit Orders</h4>
                            <p><strong>Ruthie Nhoung</strong></p>
                            <p>Production Manager</p>
                            <p><a href="mailto:ruth@nwcustomapparel.com">ruth@nwcustomapparel.com</a></p>
                            <p>253-922-5793, ext. 119</p>
                        </div>
                        <div class="contact-card">
                            <h4>🎨 Graphic Design</h4>
                            <p><strong>Steve Deland</strong></p>
                            <p>40+ Years Experience</p>
                            <p><a href="mailto:art@nwcustomapparel.com">art@nwcustomapparel.com</a></p>
                            <p>253-922-5793, ext. 103</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Email Guide Modal -->
    <div id="emailGuideModal" class="modal-backdrop">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Send Contract Embroidery Guide</h2>
                <button type="button" class="modal-close" onclick="closeEmailGuideModal()">&times;</button>
            </div>
            
            <form id="emailGuideForm">
                <div class="form-group">
                    <label class="form-label" for="guideRecipientEmail">Recipient Email *</label>
                    <input type="email" id="guideRecipientEmail" class="form-input" required 
                           placeholder="customer@example.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="guideRecipientName">Recipient Name *</label>
                    <input type="text" id="guideRecipientName" class="form-input" required 
                           placeholder="John Smith">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="guidePersonalMessage">Personal Message (optional)</label>
                    <textarea id="guidePersonalMessage" class="form-input" rows="3" 
                              placeholder="Add a personal note..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="guideSalesRep">Send From</label>
                    <select id="guideSalesRep" class="form-select" required>
                        <option value="ruth@nwcustomapparel.com" selected>Ruth</option>
                        <option value="taylar@nwcustomapparel.com">Taylar</option>
                        <option value="nika@nwcustomapparel.com">Nika</option>
                        <option value="erik@nwcustomapparel.com">Erik</option>
                        <option value="adriyella@nwcustomapparel.com">Adriyella</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-success btn-fullwidth">
                    <i class="fas fa-paper-plane"></i>
                    Send Buyer's Guide
                </button>
            </form>
            
            <div id="guideSuccessMessage" class="success-message hidden">
                <i class="fas fa-check-circle"></i>
                <span>Guide sent successfully!</span>
            </div>
            
            <div id="guideErrorMessage" class="error-message hidden">
                <i class="fas fa-exclamation-circle"></i>
                <span id="guideErrorText">An error occurred. Please try again.</span>
            </div>
        </div>
    </div>

    <script>
        // The EmbroideryCalculator class and all functions are loaded from embroidery-contract-calculator.js
        // This script just ensures everything is properly initialized
        
        console.log('Contract Embroidery Calculator HTML loaded');
        console.log('EmailJS available:', typeof emailjs !== 'undefined');
        console.log('EmbroideryCalculator class available:', typeof EmbroideryCalculator !== 'undefined');
    </script>
</body>
</html>