<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cap Sales Academy - Professional Training Simulator</title>
    <style>
        :root {
            --primary: #4cb354;
            --primary-dark: #409a47;
            --secondary: #2c3e50;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --info: #3498db;
            --light: #ecf0f1;
            --dark: #34495e;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --hover-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        .academy-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .academy-header {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
        }

        .academy-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .academy-title h1 {
            color: var(--primary);
            font-size: 2.5rem;
        }

        .academy-title .badge {
            background: var(--warning);
            color: white;
            padding: 0.25rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .academy-subtitle {
            color: var(--secondary);
            font-size: 1.1rem;
        }

        /* Progress Dashboard */
        .progress-dashboard {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
        }

        .skill-meters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .skill-meter {
            text-align: center;
        }

        .skill-meter h4 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .skill-bar {
            background: var(--light);
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .skill-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Training Modes */
        .training-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .mode-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }

        .mode-card.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .mode-card.locked::after {
            content: '🔒';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 2rem;
        }

        .mode-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .mode-title {
            color: var(--secondary);
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .mode-description {
            color: #666;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .mode-objectives {
            background: var(--light);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .mode-objectives h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .mode-objectives ul {
            list-style: none;
            padding-left: 0;
        }

        .mode-objectives li {
            padding: 0.25rem 0;
            color: #555;
            font-size: 0.9rem;
        }

        .mode-objectives li:before {
            content: '✓ ';
            color: var(--success);
            font-weight: bold;
        }

        .start-button {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .start-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 179, 84, 0.3);
        }

        .start-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Customer Simulator */
        .simulator-container {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--card-shadow);
        }

        .simulator-container.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .customer-info {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--light);
            border-radius: 10px;
        }

        .customer-avatar {
            font-size: 4rem;
        }

        .customer-details h3 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .customer-details p {
            color: #666;
            margin: 0.25rem 0;
        }

        .customer-needs {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .need-tag {
            background: var(--info);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
        }

        .conversation-area {
            border: 2px solid var(--light);
            border-radius: 10px;
            padding: 1.5rem;
            min-height: 200px;
            margin-bottom: 1.5rem;
            background: #fafafa;
        }

        .dialogue-bubble {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            animation: fadeIn 0.5s ease;
        }

        .dialogue-bubble.customer {
            background: var(--info);
            color: white;
            margin-right: 20%;
        }

        .dialogue-bubble.sales-rep {
            background: var(--success);
            color: white;
            margin-left: 20%;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .response-options {
            display: grid;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .response-option {
            background: white;
            border: 2px solid var(--light);
            padding: 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .response-option:hover {
            border-color: var(--primary);
            background: rgba(76, 179, 84, 0.05);
            transform: translateX(5px);
        }

        .response-option.selected {
            border-color: var(--success);
            background: rgba(39, 174, 96, 0.1);
        }

        .response-option.incorrect {
            border-color: var(--accent);
            background: rgba(231, 76, 60, 0.1);
        }

        /* Metrics Display */
        .metrics-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .metric-card {
            background: var(--light);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }

        .metric-label {
            color: #666;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
        }

        .metric-value.high { color: var(--success); }
        .metric-value.medium { color: var(--warning); }
        .metric-value.low { color: var(--accent); }

        /* Product Selection */
        .product-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .product-card {
            background: white;
            border: 2px solid var(--light);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .product-card:hover {
            border-color: var(--primary);
            transform: scale(1.05);
        }

        .product-card.selected {
            border-color: var(--success);
            background: rgba(39, 174, 96, 0.1);
        }

        .product-card img {
            width: 100%;
            height: 80px;
            object-fit: contain;
            margin-bottom: 0.5rem;
        }

        .product-name {
            font-size: 0.85rem;
            color: var(--secondary);
            font-weight: bold;
        }

        .product-price {
            color: var(--primary);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        /* Achievement System */
        .achievement-popup {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            animation: slideInRight 0.5s ease;
            z-index: 1000;
        }

        .achievement-popup.show {
            display: block;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .achievement-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .achievement-title {
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .achievement-description {
            color: #666;
            font-size: 0.9rem;
        }

        /* Feedback System */
        .feedback-panel {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1.5rem;
            display: none;
        }

        .feedback-panel.show {
            display: block;
        }

        .feedback-title {
            color: var(--secondary);
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feedback-content {
            color: #555;
            line-height: 1.6;
        }

        .feedback-tips {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .feedback-tips h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .feedback-tips ul {
            list-style: none;
            padding-left: 0;
        }

        .feedback-tips li {
            padding: 0.25rem 0;
            color: #666;
            font-size: 0.9rem;
        }

        .feedback-tips li:before {
            content: '💡 ';
        }

        /* Certification Badge */
        .certification-badge {
            display: none;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: var(--secondary);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }

        .certification-badge.show {
            display: block;
            animation: bounceIn 1s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .certification-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .certification-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .certification-level {
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .certification-date {
            color: #666;
            font-size: 0.9rem;
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .nav-button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            background: var(--dark);
            transform: scale(1.05);
        }

        .nav-button.primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        }

        .nav-button.primary:hover {
            box-shadow: 0 5px 15px rgba(76, 179, 84, 0.3);
        }

        /* Loading State */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem;
        }

        .loading-spinner.show {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--light);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--secondary);
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <div class="academy-container">
        <!-- Header -->
        <div class="academy-header">
            <div class="academy-title">
                <h1>🎓 Cap Sales Academy</h1>
                <span class="badge">Professional Training</span>
            </div>
            <p class="academy-subtitle">Master the art of cap sales through realistic scenarios and expert guidance</p>
        </div>

        <!-- Progress Dashboard -->
        <div class="progress-dashboard">
            <h3 style="color: var(--secondary); margin-bottom: 1rem;">Your Learning Progress</h3>
            <div class="skill-meters">
                <div class="skill-meter">
                    <h4>Product Knowledge</h4>
                    <div class="skill-bar">
                        <div class="skill-fill" id="productKnowledgeBar" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-meter">
                    <h4>Customer Communication</h4>
                    <div class="skill-bar">
                        <div class="skill-fill" id="communicationBar" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-meter">
                    <h4>Needs Assessment</h4>
                    <div class="skill-bar">
                        <div class="skill-fill" id="needsBar" style="width: 0%">0%</div>
                    </div>
                </div>
                <div class="skill-meter">
                    <h4>Solution Matching</h4>
                    <div class="skill-bar">
                        <div class="skill-fill" id="solutionBar" style="width: 0%">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Modes -->
        <div class="training-modes" id="trainingModes">
            <!-- Foundation Learning -->
            <div class="mode-card" onclick="startMode('foundation')">
                <div class="mode-icon">📚</div>
                <h3 class="mode-title">Foundation Learning</h3>
                <p class="mode-description">Build your core knowledge of cap styles, features, and applications.</p>
                <div class="mode-objectives">
                    <h4>You'll Learn:</h4>
                    <ul>
                        <li>9 top-selling cap styles</li>
                        <li>Key features and benefits</li>
                        <li>Material and construction details</li>
                        <li>Best use cases for each style</li>
                    </ul>
                </div>
                <button class="start-button">Start Learning</button>
            </div>

            <!-- Customer Conversations -->
            <div class="mode-card" onclick="startMode('conversation')">
                <div class="mode-icon">💬</div>
                <h3 class="mode-title">Customer Conversations</h3>
                <p class="mode-description">Practice real sales conversations with diverse customer personas.</p>
                <div class="mode-objectives">
                    <h4>Skills Developed:</h4>
                    <ul>
                        <li>Active listening techniques</li>
                        <li>Needs discovery questions</li>
                        <li>Product recommendations</li>
                        <li>Objection handling</li>
                    </ul>
                </div>
                <button class="start-button">Begin Practice</button>
            </div>

            <!-- Challenge Scenarios -->
            <div class="mode-card locked" onclick="startMode('challenge')">
                <div class="mode-icon">🏆</div>
                <h3 class="mode-title">Challenge Scenarios</h3>
                <p class="mode-description">Test your skills with complex, real-world sales situations.</p>
                <div class="mode-objectives">
                    <h4>Advanced Skills:</h4>
                    <ul>
                        <li>Multi-stakeholder negotiations</li>
                        <li>Custom solution design</li>
                        <li>Price justification</li>
                        <li>Closing techniques</li>
                    </ul>
                </div>
                <button class="start-button" disabled>Unlock at 80% Progress</button>
            </div>
        </div>

        <!-- Customer Simulator (Hidden Initially) -->
        <div class="simulator-container" id="simulatorContainer">
            <!-- Customer Info -->
            <div class="customer-info">
                <div class="customer-avatar" id="customerAvatar">👷</div>
                <div class="customer-details">
                    <h3 id="customerName">Mike Thompson</h3>
                    <p id="customerType">Construction Manager - Pacific Northwest Construction</p>
                    <div class="customer-needs" id="customerNeeds">
                        <span class="need-tag">Breathable</span>
                        <span class="need-tag">Durable</span>
                        <span class="need-tag">Sun Protection</span>
                    </div>
                </div>
            </div>

            <!-- Metrics Panel -->
            <div class="metrics-panel">
                <div class="metric-card">
                    <div class="metric-label">Rapport</div>
                    <div class="metric-value high" id="rapportScore">85%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Trust</div>
                    <div class="metric-value medium" id="trustScore">65%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Satisfaction</div>
                    <div class="metric-value high" id="satisfactionScore">90%</div>
                </div>
            </div>

            <!-- Conversation Area -->
            <div class="conversation-area" id="conversationArea">
                <div class="dialogue-bubble customer">
                    Hi! I need caps for my construction crew. We work outdoors in all weather conditions, and the guys are pretty rough on their gear. What would you recommend?
                </div>
            </div>

            <!-- Response Options -->
            <div class="response-options" id="responseOptions">
                <div class="response-option" onclick="selectResponse(0)">
                    "I'd be happy to help! Can you tell me more about your crew size and any specific features that are important to you?"
                </div>
                <div class="response-option" onclick="selectResponse(1)">
                    "We have lots of caps! The C112 is our best seller. How many do you need?"
                </div>
                <div class="response-option" onclick="selectResponse(2)">
                    "Construction work requires durable headwear. Let me show you our most rugged options with excellent sun protection."
                </div>
            </div>

            <!-- Product Selector (Hidden Initially) -->
            <div class="product-selector" id="productSelector" style="display: none;">
                <!-- Products will be loaded dynamically -->
            </div>

            <!-- Feedback Panel -->
            <div class="feedback-panel" id="feedbackPanel">
                <h3 class="feedback-title">
                    <span>💡</span> Learning Insight
                </h3>
                <div class="feedback-content" id="feedbackContent">
                    Great choice! By asking discovery questions first, you show genuine interest in solving the customer's problem rather than just making a sale.
                </div>
                <div class="feedback-tips">
                    <h4>Pro Tips:</h4>
                    <ul id="feedbackTips">
                        <li>Always understand the use case before recommending products</li>
                        <li>Consider environmental factors like weather and job site conditions</li>
                        <li>Think about company branding requirements</li>
                    </ul>
                </div>
            </div>

            <!-- Navigation -->
            <div class="nav-buttons">
                <button class="nav-button" onclick="exitSimulator()">Exit to Menu</button>
                <button class="nav-button primary" onclick="nextScenario()">Next Customer</button>
            </div>
        </div>

        <!-- Achievement Popup -->
        <div class="achievement-popup" id="achievementPopup">
            <div class="achievement-icon">🏆</div>
            <div class="achievement-title">Achievement Unlocked!</div>
            <div class="achievement-description" id="achievementDescription">First Perfect Conversation</div>
        </div>

        <!-- Certification Badge -->
        <div class="certification-badge" id="certificationBadge">
            <div class="certification-icon">🏅</div>
            <div class="certification-title">Certification Earned!</div>
            <div class="certification-level" id="certificationLevel">Bronze Level - Cap Sales Associate</div>
            <div class="certification-date" id="certificationDate">Achieved on January 11, 2025</div>
        </div>

        <!-- Loading State -->
        <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner"></div>
            <div class="loading-text">Loading training materials...</div>
        </div>
    </div>

    <script>
        // Training Data
        const capsData = [
            {
                style: 'C112',
                name: 'Port Authority Snapback Trucker Cap',
                description: 'Two-toned with breathable mesh',
                image: 'https://cdnm.sanmar.com/catalog/images/C112.jpg',
                features: ['Breathable mesh', 'Structured', 'Snapback closure'],
                bestFor: 'Outdoor work, casual wear',
                price: '$12.48'
            },
            {
                style: 'NE1000',
                name: 'New Era Structured Stretch Cotton Cap',
                description: 'Premium stretch fit in breathable cotton',
                image: 'https://cdnm.sanmar.com/catalog/images/NE1000.jpg',
                features: ['97/3 cotton/spandex', 'Stretch fit', 'Structured'],
                bestFor: 'Professional teams, athletic wear',
                price: '$20.43'
            },
            {
                style: 'C110',
                name: 'Port Authority Flexfit 110 Mesh Cap',
                description: 'Perfect blend of Flexfit technology and adjustability',
                image: 'https://cdnm.sanmar.com/catalog/images/C110.jpg',
                features: ['Flexfit 110 technology', 'Mesh panels', 'Snapback'],
                bestFor: 'Sports teams, active wear',
                price: '$20.10'
            },
            {
                style: 'CP90',
                name: 'Port Company Knit Cap',
                description: 'Warm knit cap for cooler weather',
                image: 'https://cdnm.sanmar.com/catalog/images/CP90.jpg',
                features: ['100% acrylic', '3-inch folding cuff', 'Easy embroidery'],
                bestFor: 'Winter wear, outdoor crews',
                price: '$9.71'
            },
            {
                style: 'C826',
                name: 'Port Authority Pique Mesh Cap',
                description: 'Ultra-breathable pique and air mesh',
                image: 'https://cdnm.sanmar.com/catalog/images/C826.jpg',
                features: ['Polyester pique', 'Air mesh back', 'Structured'],
                bestFor: 'Hot climates, athletic events',
                price: '$16.35'
            },
            {
                style: 'C912',
                name: 'Port Authority Camouflage Cap',
                description: 'Camo print with air mesh back',
                image: 'https://cdnm.sanmar.com/catalog/images/C912.jpg',
                features: ['60/40 cotton/poly', 'Camo pattern', 'Hook and loop'],
                bestFor: 'Outdoor recreation, hunting',
                price: '$16.93'
            },
            {
                style: 'C114',
                name: 'Port Authority Digi Camo Snapback',
                description: 'Digital camo pattern trucker',
                image: 'https://cdnm.sanmar.com/catalog/images/C114.jpg',
                features: ['Digital camo', 'Mesh back', 'Snapback'],
                bestFor: 'Tactical teams, outdoor sports',
                price: '$8.72'
            },
            {
                style: 'CP82',
                name: 'Port Company Brushed Twill Cap',
                description: 'Soft-brushed twill classic',
                image: 'https://cdnm.sanmar.com/catalog/images/CP82b.jpg',
                features: ['100% cotton', 'Brass buckle closure', 'Structured'],
                bestFor: 'Casual wear, company uniforms',
                price: '$11.55'
            },
            {
                style: 'C865',
                name: 'Port Authority Flexfit Cap',
                description: 'The original Flexfit cap',
                image: 'https://cdnm.sanmar.com/catalog/images/C865.jpg',
                features: ['Poly/cotton/spandex', 'Stretch fit', 'Permacurv bill'],
                bestFor: 'Athletic teams, all-day comfort',
                price: '$24.77'
            }
        ];

        // Customer Personas
        const customerPersonas = [
            {
                name: 'Mike Thompson',
                type: 'Construction Manager',
                company: 'Pacific Northwest Construction',
                avatar: '👷',
                needs: ['breathable', 'durable', 'sun protection'],
                initialDialogue: "Hi! I need caps for my construction crew. We work outdoors in all weather conditions, and the guys are pretty rough on their gear. What would you recommend?",
                goodResponses: ['discovery questions', 'durability focus', 'mesh recommendation'],
                badResponses: ['price first', 'no questions', 'wrong product'],
                idealProduct: 'C112',
                budget: 'moderate'
            },
            {
                name: 'Sarah Chen',
                type: 'Marketing Director',
                company: 'Tech Startup Solutions',
                avatar: '👩‍💼',
                needs: ['professional', 'brand-conscious', 'modern'],
                initialDialogue: "We're looking for branded caps for our company retreat. We want something that looks professional but still cool and modern. Any suggestions?",
                goodResponses: ['brand alignment', 'quality focus', 'style options'],
                badResponses: ['cheap options', 'outdated styles', 'no customization talk'],
                idealProduct: 'NE1000',
                budget: 'high'
            },
            {
                name: 'Coach Rodriguez',
                type: 'Youth Sports Coach',
                company: 'Riverside Little League',
                avatar: '⚾',
                needs: ['team unity', 'affordable', 'youth sizes'],
                initialDialogue: "I need team caps for our Little League team. We have 15 kids aged 8-12, and our budget is pretty tight. What are our options?",
                goodResponses: ['budget awareness', 'youth sizing', 'bulk discount'],
                badResponses: ['expensive options', 'ignore budget', 'adult sizing only'],
                idealProduct: 'CP82',
                budget: 'low'
            },
            {
                name: 'Jennifer Walsh',
                type: 'Event Coordinator',
                company: 'Outdoor Adventures Inc.',
                avatar: '🏕️',
                needs: ['weather-resistant', 'versatile', 'quick-dry'],
                initialDialogue: "We run outdoor adventure tours and need caps for our guides and participants. They need to work in rain or shine. What do you have?",
                goodResponses: ['weather features', 'moisture-wicking', 'versatility'],
                badResponses: ['cotton only', 'no weather discussion', 'single use'],
                idealProduct: 'C826',
                budget: 'moderate-high'
            },
            {
                name: 'Tom Bradley',
                type: 'Restaurant Owner',
                company: "Bradley's BBQ House",
                avatar: '👨‍🍳',
                needs: ['washable', 'professional', 'comfortable'],
                initialDialogue: "I need caps for my restaurant staff. They need to look professional but also be easy to clean. We go through a lot of them!",
                goodResponses: ['hygiene focus', 'durability', 'bulk ordering'],
                badResponses: ['delicate materials', 'hard to clean', 'no volume discussion'],
                idealProduct: 'C110',
                budget: 'moderate'
            }
        ];

        // Game State
        let gameState = {
            currentMode: null,
            currentCustomer: null,
            currentScenario: 0,
            conversationStage: 0,
            rapport: 50,
            trust: 50,
            satisfaction: 50,
            productKnowledge: 0,
            communication: 0,
            needsAssessment: 0,
            solutionMatching: 0,
            achievements: [],
            conversationHistory: [],
            selectedProducts: []
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            updateSkillBars();
        });

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('capAcademyProgress');
            if (saved) {
                const progress = JSON.parse(saved);
                gameState = { ...gameState, ...progress };
                updateSkillBars();
                checkUnlocks();
            }
        }

        // Save progress
        function saveProgress() {
            localStorage.setItem('capAcademyProgress', JSON.stringify(gameState));
        }

        // Update skill bars
        function updateSkillBars() {
            updateSkillBar('productKnowledgeBar', gameState.productKnowledge);
            updateSkillBar('communicationBar', gameState.communication);
            updateSkillBar('needsBar', gameState.needsAssessment);
            updateSkillBar('solutionBar', gameState.solutionMatching);
        }

        function updateSkillBar(barId, value) {
            const bar = document.getElementById(barId);
            if (bar) {
                bar.style.width = value + '%';
                bar.textContent = value + '%';
            }
        }

        // Start training mode
        function startMode(mode) {
            if (mode === 'challenge' && getOverallProgress() < 80) {
                showAchievement('Locked', 'Complete more training to unlock challenges');
                return;
            }

            gameState.currentMode = mode;
            document.getElementById('trainingModes').style.display = 'none';
            
            if (mode === 'conversation') {
                startConversationMode();
            } else if (mode === 'foundation') {
                startFoundationMode();
            } else if (mode === 'challenge') {
                startChallengeMode();
            }
        }

        // Start conversation mode
        function startConversationMode() {
            const simulator = document.getElementById('simulatorContainer');
            simulator.classList.add('active');
            
            // Load random customer
            loadNewCustomer();
        }

        // Load new customer
        function loadNewCustomer() {
            const customer = customerPersonas[Math.floor(Math.random() * customerPersonas.length)];
            gameState.currentCustomer = customer;
            gameState.conversationStage = 0;
            gameState.rapport = 50;
            gameState.trust = 50;
            gameState.satisfaction = 50;
            gameState.conversationHistory = [];
            
            // Update UI
            document.getElementById('customerAvatar').textContent = customer.avatar;
            document.getElementById('customerName').textContent = customer.name;
            document.getElementById('customerType').textContent = customer.type + ' - ' + customer.company;
            
            // Update needs tags
            const needsContainer = document.getElementById('customerNeeds');
            needsContainer.innerHTML = '';
            customer.needs.forEach(need => {
                const tag = document.createElement('span');
                tag.className = 'need-tag';
                tag.textContent = need.charAt(0).toUpperCase() + need.slice(1);
                needsContainer.appendChild(tag);
            });
            
            // Start conversation
            const conversationArea = document.getElementById('conversationArea');
            conversationArea.innerHTML = `
                <div class="dialogue-bubble customer">
                    ${customer.initialDialogue}
                </div>
            `;
            
            // Generate response options
            generateResponseOptions();
            updateMetrics();
        }

        // Generate response options
        function generateResponseOptions() {
            const responseOptions = [
                {
                    text: "I'd be happy to help! Can you tell me more about your specific needs and any features that are important to you?",
                    type: 'discovery',
                    impact: { rapport: 10, trust: 5, satisfaction: 5 }
                },
                {
                    text: `We have excellent options for ${gameState.currentCustomer.type.toLowerCase()}s. Let me show you our most popular styles.`,
                    type: 'direct',
                    impact: { rapport: 0, trust: 0, satisfaction: 0 }
                },
                {
                    text: `Based on what you've told me, I think the ${capsData[Math.floor(Math.random() * 3)].name} would be perfect for your needs.`,
                    type: 'assumption',
                    impact: { rapport: -5, trust: -5, satisfaction: -5 }
                }
            ];
            
            const optionsContainer = document.getElementById('responseOptions');
            optionsContainer.innerHTML = '';
            
            responseOptions.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'response-option';
                optionDiv.textContent = option.text;
                optionDiv.onclick = () => selectResponse(index, option);
                optionsContainer.appendChild(optionDiv);
            });
        }

        // Select response
        function selectResponse(index, response) {
            // Apply impact
            if (response) {
                gameState.rapport = Math.max(0, Math.min(100, gameState.rapport + response.impact.rapport));
                gameState.trust = Math.max(0, Math.min(100, gameState.trust + response.impact.trust));
                gameState.satisfaction = Math.max(0, Math.min(100, gameState.satisfaction + response.impact.satisfaction));
            }
            
            // Update conversation
            const conversationArea = document.getElementById('conversationArea');
            const responseDiv = document.createElement('div');
            responseDiv.className = 'dialogue-bubble sales-rep';
            responseDiv.textContent = response ? response.text : 'Let me help you find the perfect cap.';
            conversationArea.appendChild(responseDiv);
            
            // Customer response
            setTimeout(() => {
                generateCustomerResponse(response ? response.type : 'neutral');
            }, 1000);
            
            updateMetrics();
            
            // Update skills
            if (response && response.type === 'discovery') {
                gameState.communication = Math.min(100, gameState.communication + 2);
                gameState.needsAssessment = Math.min(100, gameState.needsAssessment + 3);
            }
            
            updateSkillBars();
            saveProgress();
        }

        // Generate customer response
        function generateCustomerResponse(responseType) {
            let customerResponse = '';
            
            if (responseType === 'discovery') {
                customerResponse = "That's great! We have about 20 crew members, and we really need something that won't trap heat. Many of them also wear hard hats, so adjustability is important.";
                
                // Show product selector
                setTimeout(() => showProductSelector(), 1500);
            } else if (responseType === 'direct') {
                customerResponse = "Okay, show me what you've got. We're looking for good value.";
            } else {
                customerResponse = "Hmm, I'm not sure that's quite what we need. Can you tell me more about other options?";
            }
            
            const conversationArea = document.getElementById('conversationArea');
            const responseDiv = document.createElement('div');
            responseDiv.className = 'dialogue-bubble customer';
            responseDiv.textContent = customerResponse;
            conversationArea.appendChild(responseDiv);
            
            // Scroll to bottom
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }

        // Show product selector
        function showProductSelector() {
            const selector = document.getElementById('productSelector');
            selector.style.display = 'grid';
            selector.innerHTML = '';
            
            // Add relevant products
            const relevantCaps = capsData.slice(0, 6);
            relevantCaps.forEach(cap => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    <img src="${cap.image}" alt="${cap.name}">
                    <div class="product-name">${cap.style}</div>
                    <div class="product-price">${cap.price}</div>
                `;
                card.onclick = () => selectProduct(cap);
                selector.appendChild(card);
            });
            
            // Show feedback
            showFeedback('discovery');
        }

        // Select product
        function selectProduct(cap) {
            gameState.selectedProducts.push(cap);
            
            // Check if it's a good match
            const customer = gameState.currentCustomer;
            if (cap.style === customer.idealProduct) {
                gameState.satisfaction = Math.min(100, gameState.satisfaction + 20);
                gameState.solutionMatching = Math.min(100, gameState.solutionMatching + 5);
                showFeedback('perfect_match');
            } else {
                showFeedback('good_choice');
            }
            
            updateMetrics();
            updateSkillBars();
            saveProgress();
        }

        // Update metrics display
        function updateMetrics() {
            updateMetric('rapportScore', gameState.rapport);
            updateMetric('trustScore', gameState.trust);
            updateMetric('satisfactionScore', gameState.satisfaction);
        }

        function updateMetric(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value + '%';
                element.className = 'metric-value ' + (value >= 70 ? 'high' : value >= 40 ? 'medium' : 'low');
            }
        }

        // Show feedback
        function showFeedback(type) {
            const panel = document.getElementById('feedbackPanel');
            const content = document.getElementById('feedbackContent');
            const tips = document.getElementById('feedbackTips');
            
            panel.classList.add('show');
            
            if (type === 'discovery') {
                content.textContent = "Excellent! By asking discovery questions, you're building trust and gathering crucial information to make the best recommendation.";
                tips.innerHTML = `
                    <li>Always understand the use case before recommending products</li>
                    <li>Consider environmental factors like weather and job site conditions</li>
                    <li>Think about company branding requirements</li>
                `;
            } else if (type === 'perfect_match') {
                content.textContent = "Perfect match! You've selected the ideal product for this customer's needs. This shows excellent product knowledge and listening skills.";
                tips.innerHTML = `
                    <li>Explain why this specific cap meets their needs</li>
                    <li>Discuss customization options for their brand</li>
                    <li>Mention bulk pricing to add value</li>
                `;
                
                // Award achievement
                if (!gameState.achievements.includes('perfect_match')) {
                    gameState.achievements.push('perfect_match');
                    showAchievement('Perfect Match!', 'Selected the ideal product for a customer');
                }
            }
        }

        // Show achievement
        function showAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementDescription').textContent = description;
            
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        // Get overall progress
        function getOverallProgress() {
            return Math.floor((gameState.productKnowledge + gameState.communication + 
                              gameState.needsAssessment + gameState.solutionMatching) / 4);
        }

        // Check unlocks
        function checkUnlocks() {
            const progress = getOverallProgress();
            const challengeCard = document.querySelector('.mode-card.locked');
            
            if (progress >= 80 && challengeCard) {
                challengeCard.classList.remove('locked');
                const button = challengeCard.querySelector('.start-button');
                button.disabled = false;
                button.textContent = 'Start Challenge';
            }
            
            // Check for certification
            if (progress >= 100 && !gameState.achievements.includes('certified')) {
                gameState.achievements.push('certified');
                showCertification('Gold');
            } else if (progress >= 75 && !gameState.achievements.includes('silver')) {
                gameState.achievements.push('silver');
                showCertification('Silver');
            } else if (progress >= 50 && !gameState.achievements.includes('bronze')) {
                gameState.achievements.push('bronze');
                showCertification('Bronze');
            }
        }

        // Show certification
        function showCertification(level) {
            const badge = document.getElementById('certificationBadge');
            document.getElementById('certificationLevel').textContent = `${level} Level - Cap Sales ${level === 'Gold' ? 'Expert' : level === 'Silver' ? 'Professional' : 'Associate'}`;
            document.getElementById('certificationDate').textContent = `Achieved on ${new Date().toLocaleDateString()}`;
            
            badge.classList.add('show');
            setTimeout(() => {
                badge.classList.remove('show');
            }, 5000);
        }

        // Exit simulator
        function exitSimulator() {
            document.getElementById('simulatorContainer').classList.remove('active');
            document.getElementById('trainingModes').style.display = 'grid';
            checkUnlocks();
        }

        // Next scenario
        function nextScenario() {
            loadNewCustomer();
            document.getElementById('feedbackPanel').classList.remove('show');
            document.getElementById('productSelector').style.display = 'none';
        }

        // Start foundation mode (simplified for space)
        function startFoundationMode() {
            // This would show product cards with detailed information
            alert('Foundation mode would show interactive product cards with all cap details. This is a placeholder for the full implementation.');
            gameState.productKnowledge = Math.min(100, gameState.productKnowledge + 10);
            updateSkillBars();
            saveProgress();
        }

        // Start challenge mode
        function startChallengeMode() {
            alert('Challenge mode presents complex scenarios with multiple stakeholders and advanced objections. Full implementation coming soon!');
        }
    </script>
</body>
</html>