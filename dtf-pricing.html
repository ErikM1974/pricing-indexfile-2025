<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DTF Pricing | NWCA</title>
    <link rel="stylesheet" href="/shared_components/css/shared-pricing-styles.css">
    <link rel="stylesheet" href="/shared_components/css/modern-enhancements.css">
    <!-- jsPDF Libraries for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* Essential layout styles from cap-embroidery page */
        .product-page-columns-container {
            display: flex;
            flex-direction: row;
            gap: 20px;
        }
        
        .product-context-column {
            flex: 0 0 350px;
            min-width: 0;
        }
        
        .product-interactive-column {
            flex: 1;
            min-width: 0;
        }
        
        /* Product header styles */
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-bottom: 15px;
        }
        
        .product-title-area {
            flex: 1;
        }
        
        .product-title-area h2 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.5em;
        }
        
        .navigation-area {
            margin-left: 20px;
        }
        
        .back-to-product {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background-color: var(--primary-light);
            color: var(--primary-color);
            text-decoration: none;
            border-radius: var(--radius-sm);
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .back-to-product:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* Product image gallery styles */
        .product-image-gallery {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .main-image-container {
            position: relative;
            width: 100%;
            background-color: #f8f9fa;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            margin-bottom: 15px;
        }
        
        .main-image-container img {
            width: 100%;
            height: auto;
            display: block;
            min-height: 400px;
            object-fit: contain;
            background-color: white;
        }
        
        .image-loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .main-image-container.loading .image-loading-spinner {
            display: block;
        }
        
        .image-thumbnails {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--primary-light);
        }
        
        .image-thumbnails::-webkit-scrollbar {
            height: 6px;
        }
        
        .image-thumbnails::-webkit-scrollbar-track {
            background: var(--primary-light);
            border-radius: 3px;
        }
        
        .image-thumbnails::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 3px;
        }
        
        .thumbnail-item {
            flex: 0 0 80px;
            height: 80px;
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: white;
            position: relative;
        }
        
        .thumbnail-item:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .thumbnail-item.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }
        
        .thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-zoom-overlay {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .main-image-container:hover .image-zoom-overlay {
            opacity: 1;
        }
        
        /* Color swatches styles */
        .color-swatches-container {
            background-color: var(--background-light);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 1px solid var(--border-light);
        }
        
        .color-swatches-container .section-title {
            font-size: 1.1em;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-light);
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .color-swatches {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            max-height: 350px;
            overflow-y: auto;
            padding: 10px 15px;
            gap: 15px;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--primary-light);
        }
        
        .swatch-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
            min-height: 75px;
            margin: 5px;
            cursor: pointer;
            justify-content: flex-start;
        }
        
        .color-swatch {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            margin-bottom: 4px;
            background-size: cover;
            background-position: center;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        
        .color-swatch:hover {
            border-color: var(--primary-color);
        }
        
        .color-swatch.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }
        
        .color-name {
            font-size: 0.75em;
            text-align: center;
            color: var(--text-color);
            width: 100%;
            padding: 0 2px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            display: block;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .product-page-columns-container {
                flex-direction: column;
            }
            
            .product-context-column {
                flex: 0 0 auto;
                width: 100%;
                margin-bottom: 20px;
            }
            
            .product-interactive-column {
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .product-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .navigation-area {
                margin-left: 0;
                margin-top: 10px;
                align-self: flex-start;
            }
            
            .main-image-container img {
                min-height: 300px;
            }
            
            .thumbnail-item {
                flex: 0 0 60px;
                height: 60px;
            }
        }
        
        /* Section title styles */
        .section-title {
            font-size: 1.2em;
            color: #333;
            margin: 25px 0 15px 0;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
            font-weight: 600;
        }
        
        .section-title:first-child {
            border-top: none;
            padding-top: 0;
            margin-top: 0;
        }
        
        /* Product meta styles */
        .product-meta {
            font-size: 0.9em;
            color: #666;
        }
        
        .meta-item {
            display: inline-block;
            margin-right: 15px;
        }
        
        /* DTF-specific styles */
        .dtf-transfer-section {
            background-color: var(--background-light);
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            border: 1px solid var(--border-light);
        }
        
        .transfer-location {
            background-color: var(--white);
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }
        
        .location-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .location-title {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .transfer-size-selector {
            margin-bottom: 15px;
        }
        
        .transfer-size-selector label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .transfer-size-selector select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 1em;
            background-color: var(--white);
            transition: border-color 0.3s ease;
        }
        
        .transfer-size-selector select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }
        
        .add-location-btn {
            background-color: var(--primary-light);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }
        
        .add-location-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .remove-location-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }
        
        .remove-location-btn:hover {
            background-color: #c82333;
        }
        
        .pricing-formula-box {
            background-color: #f0f7ed;
            border: 2px solid var(--primary-color);
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .pricing-formula-box h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .formula-steps {
            display: inline-block;
            text-align: left;
            margin-top: 10px;
            background: white;
            padding: 15px 25px;
            border-radius: var(--radius-sm);
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            box-shadow: var(--shadow-sm);
        }
        
        .garment-cost-section {
            background-color: var(--primary-light);
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
        }
        
        .garment-cost-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1em;
        }
        
        .garment-cost-label {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .garment-cost-value {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--primary-dark);
        }
        
        .cost-source {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        /* Pricing breakdown styles */
        .pricing-breakdown {
            background-color: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            margin-top: 20px;
            overflow: hidden;
        }
        
        .breakdown-accordion-header {
            background-color: var(--background-light);
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
            border: 1px solid var(--border-color);
        }
        
        .breakdown-accordion-header:hover {
            background-color: #e8f5e9;
        }
        
        .breakdown-accordion-header h3 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.2em;
        }
        
        .breakdown-accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: var(--white);
        }
        
        .pricing-breakdown.active .breakdown-accordion-content {
            max-height: 1500px;
        }
        
        .breakdown-inner {
            padding: 20px;
        }
        
        .breakdown-title {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-light);
        }
        
        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .breakdown-item.indented {
            padding-left: 30px;
        }
        
        .breakdown-item.sub-item {
            padding-left: 50px;
            font-size: 0.95em;
        }
        
        .breakdown-item:last-child {
            border-bottom: none;
        }
        
        .breakdown-label {
            color: #666;
            font-size: 0.95em;
        }
        
        .breakdown-value {
            font-weight: 600;
            color: #333;
        }
        
        .breakdown-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            margin-top: 10px;
            border-top: 2px solid var(--primary-color);
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        /* Tier pricing display */
        .tier-pricing-display {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: var(--radius-md);
            margin-top: 20px;
            border: 1px solid #e0e0e0;
        }
        
        .tier-pricing-title {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }
        
        .tier-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .tier-card {
            background: white;
            padding: 15px;
            border-radius: var(--radius-sm);
            text-align: center;
            box-shadow: var(--shadow-sm);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tier-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .tier-card.current {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
        }
        
        .tier-qty {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .tier-price {
            font-size: 1.6em;
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .tier-note {
            font-size: 0.85em;
            color: #777;
            margin-top: 5px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .tier-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 10px;
            }
            
            .tier-card {
                padding: 10px;
            }
            
            .tier-price {
                font-size: 1.4em;
            }
        }
        
        /* Accordion styles */
        .accordion {
            margin-top: 30px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        .accordion-header {
            background-color: var(--background-light);
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }
        
        .accordion-header:hover {
            background-color: #e8f5e9;
        }
        
        .accordion-header h3 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.1em;
        }
        
        .accordion-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }
        
        .accordion.active .accordion-icon {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: #f0f7ed;
        }
        
        .accordion.active .accordion-content {
            max-height: 500px;
        }
        
        .accordion-inner {
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Direct-to-Film (DTF) Transfer Pricing</h1>

        <!-- New Two-Column Layout Container -->
        <div class="product-page-columns-container">

            <!-- Left Column: Product Context -->
            <div class="product-context-column">
                <div class="product-header">
                    <div class="product-title-area">
                        <h2 id="product-title-context">Loading Product...</h2>
                        <div class="product-meta" style="padding-top: 8px; margin-bottom: 5px;">
                            <span class="meta-item">Style: <strong id="product-style-context">Loading...</strong></span>
                        </div>
                    </div>
                    <div class="navigation-area">
                        <a id="back-to-product" href="#" class="back-to-product">
                            <span class="back-icon">←</span> Back to Product
                        </a>
                    </div>
                </div>
                
                <!-- Enhanced Product Image Gallery -->
                <div class="product-image-gallery" id="product-image-gallery">
                    <div class="main-image-container" id="main-image-container">
                        <img id="product-image-main" src="" alt="Product Image" class="product-image">
                        <div class="image-loading-spinner"></div>
                        <div class="image-zoom-overlay">
                            <span class="zoom-icon">🔍</span>
                        </div>
                    </div>
                    <div class="image-thumbnails" id="image-thumbnails">
                        <!-- Thumbnails will be dynamically added here -->
                    </div>
                </div>
                
                <div class="static-product-info" style="padding:15px; background-color: var(--background-light); border-radius: var(--radius-sm); margin-top:15px;">
                    <p><strong>DTF Transfer Printing:</strong> Vibrant, full-color designs with excellent durability and stretch. Perfect for both light and dark garments.</p>
                </div>
                
                <!-- Color Swatches -->
                <div class="color-swatches-left-column" style="margin-top:15px;">
                    <div class="color-swatches-container compact">
                        <h3 class="section-title">Available Colors</h3>
                        <div class="color-swatches collapsed" id="color-swatches" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 5px; max-height: 300px;">
                            <!-- Color swatches will be dynamically added here -->
                        </div>
                        <button class="show-more-colors" id="show-more-colors" style="display: none;">Show More Colors</button>
                    </div>
                </div>
            </div>

            <!-- Right Column: Interactive Elements -->
            <div class="product-interactive-column">
                
                
                <!-- DTF Transfer Configuration -->
                <div class="dtf-transfer-section">
                    <h3 class="section-title">Configure Your DTF Transfers</h3>
                    
                    <div id="locationsContainer">
                        <!-- First location (always present) -->
                        <div class="transfer-location" id="location1">
                            <div class="location-header">
                                <div class="location-title">Location 1: Primary Transfer</div>
                            </div>
                            
                            <div class="transfer-size-selector">
                                <label for="category1">Transfer Category</label>
                                <select id="category1" onchange="updateTransferSizes(1)">
                                    <option value="small">Small Transfers (1.5" - 5.8")</option>
                                    <option value="large">Large Transfers (8.3" - 16.5")</option>
                                </select>
                            </div>

                            <div class="transfer-size-selector">
                                <label for="size1">Transfer Size</label>
                                <select id="size1">
                                    <!-- Options will be populated by JavaScript -->
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="quantity1">Quantity</label>
                                <input type="number" id="quantity1" min="1" placeholder="Enter quantity" required style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: var(--radius-sm); font-size: 1em;">
                                <div class="info-text" style="font-size: 0.85em; color: #777; margin-top: 5px; font-style: italic;">Orders under 24 pieces: $50 minimum charge</div>
                            </div>
                        </div>
                    </div>

                    <button class="add-location-btn" onclick="toggleSecondLocation()">
                        <span id="addLocationText">+ Add Second Location</span>
                    </button>
                </div>
                
                <!-- Calculate Button -->
                <button onclick="calculateDTFPrice()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); color: white; border: none; border-radius: var(--radius-sm); font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 20px;">
                    Calculate DTF Pricing
                </button>
                
                <!-- Pricing Results -->
                <div id="pricing-results" style="display: none;">
                    <div class="pricing-breakdown" id="pricing-breakdown-accordion" data-require-password="false">
                        <div class="breakdown-accordion-header" onclick="togglePricingBreakdown()">
                            <h3>💰 Cost Analysis (Internal Use)</h3>
                            <span class="accordion-icon">▼</span>
                        </div>
                        <div class="breakdown-accordion-content">
                            <div class="breakdown-inner">
                                <div id="breakdown-details">
                                    <!-- Breakdown will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tier-pricing-display" id="tier-pricing-display">
                        <!-- Tier pricing will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Pricing Formula Accordion (moved to bottom) -->
                <div class="accordion" id="pricing-formula-accordion">
                    <div class="accordion-header" onclick="toggleAccordion()">
                        <h3>📊 Pricing Formula</h3>
                        <span class="accordion-icon">▼</span>
                    </div>
                    <div class="accordion-content">
                        <div class="accordion-inner">
                            <p>We calculate your price by applying our margin to the product costs, then adding operational expenses:</p>
                            <div class="formula-steps">
                                1. Garment Price = Blank Garment ÷ 0.60 (40% margin)<br>
                                2. Transfer Price = Already includes margin<br>
                                3. Final Price = Garment Price + Transfer(s) + Freight + Labor<br>
                                <br>
                                <strong>Pricing Tiers:</strong> 24-47 | 48-71 | 72-100 | 101-250 | 251+<br>
                                <strong>Minimum:</strong> Orders under 24 = $50 setup charge<br>
                                <strong>Multi-Location:</strong> Labor doubles for each additional transfer<br>
                                <br>
                                <strong>Size Upcharges:</strong> Larger sizes (2XL+) add $2-7 to final price
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Hidden elements for compatibility with shared scripts -->
                <div id="pricing-calculator" class="pricing-calculator" style="display:none !important; width:0; height:0; border:0; visibility: hidden;">
                    <div class="loading-message">Loading pricing data...</div>
                </div>
                
                <!-- Hidden quantity matrix for script compatibility -->
                <div id="quantity-matrix" style="display:none !important;"></div>
                
                <!-- Hidden add to cart button for script compatibility -->
                <button id="add-to-cart-button" style="display:none !important;">Add to Cart</button>
                
                <!-- Hidden matrix elements for script compatibility -->
                <div class="matrix-price-table" style="display:none !important;"></div>
                <div id="matrix-note" style="display:none !important;"></div>
                
                <!-- Hidden sticky summary for script compatibility -->
                <div class="sticky-summary" style="display:none !important;">
                    <div id="totalAmountDisplay"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript Files -->
    <script src="/shared_components/js/pricing-pages.js"></script>
    <script src="/shared_components/js/utils.js"></script>
    <script src="/shared_components/js/pricing-matrix-capture.js"></script>
    <script src="/shared_components/js/pricing-matrix-api.js"></script>
    <script src="/shared_components/js/dp5-helper.js"></script>
    <script src="/shared_components/js/product-quantity-ui.js"></script>
    <script src="/shared_components/js/cart.js"></script>
    <script src="/shared_components/js/cart-integration.js"></script>
    <script src="/shared_components/js/cart-price-recalculator.js"></script>
    <script src="/shared_components/js/add-to-cart.js"></script>
    <script src="/shared_components/js/pricing-calculator.js"></script>
<script src="/shared_components/js/dtf-adapter.js"></script>
    <script src="/shared_components/js/product-pricing-ui.js"></script>
    
    <!-- DTF-specific JavaScript -->
    <script>
        // Constants
        const FREIGHT_COST = 15.00;
        const LABOR_COST_PER_TRANSFER = 2.00;
        const MINIMUM_CHARGE = 50.00;
        const MINIMUM_CHARGE_QTY = 24;
        const TARGET_MARGIN = 0.40; // 40% gross margin
        const MARGIN_DIVISOR = 1 - TARGET_MARGIN; // 0.60

        let hasSecondLocation = false;
        let garmentCost = 0; // Will be populated from API

        // Pricing tiers
        const PRICING_TIERS = [
            { min: 1, max: 23, label: "Under 24", isLTM: true },
            { min: 24, max: 47, label: "24-47", baseQty: 24 },
            { min: 48, max: 71, label: "48-71", baseQty: 48 },
            { min: 72, max: 100, label: "72-100", baseQty: 72 },
            { min: 101, max: 250, label: "101-250", baseQty: 101 },
            { min: 251, max: 999999, label: "251+", baseQty: 251 }
        ];

        // DTF Transfer pricing data
        const dtfPricingData = {
            small: {
                sizes: [
                    '1.5" x 1.5"',
                    '2.5" x 2.5"',
                    '4" x 4" (Left Chest)',
                    '5.8" x 8.3"'
                ],
                prices: {
                    '1.5" x 1.5"': [
                        {min: 10, max: 19, price: 5.25},
                        {min: 20, max: 49, price: 4.25},
                        {min: 50, max: 99, price: 2.50},
                        {min: 100, max: 199, price: 1.75},
                        {min: 200, max: 299, price: 1.50},
                        {min: 300, max: 499, price: 1.25},
                        {min: 500, max: 999, price: 1.00},
                        {min: 1000, max: 2499, price: 1.00},
                        {min: 2500, max: 4999, price: 1.00},
                        {min: 5000, max: 999999, price: 1.00}
                    ],
                    '2.5" x 2.5"': [
                        {min: 10, max: 19, price: 5.75},
                        {min: 20, max: 49, price: 4.75},
                        {min: 50, max: 99, price: 3.25},
                        {min: 100, max: 199, price: 2.25},
                        {min: 200, max: 299, price: 2.00},
                        {min: 300, max: 499, price: 1.50},
                        {min: 500, max: 999, price: 1.50},
                        {min: 1000, max: 2499, price: 1.25},
                        {min: 2500, max: 4999, price: 1.25},
                        {min: 5000, max: 999999, price: 1.25}
                    ],
                    '4" x 4" (Left Chest)': [
                        {min: 10, max: 19, price: 6.25},
                        {min: 20, max: 49, price: 5.25},
                        {min: 50, max: 99, price: 4.00},
                        {min: 100, max: 199, price: 3.00},
                        {min: 200, max: 299, price: 2.50},
                        {min: 300, max: 499, price: 2.25},
                        {min: 500, max: 999, price: 2.25},
                        {min: 1000, max: 2499, price: 2.00},
                        {min: 2500, max: 4999, price: 2.00},
                        {min: 5000, max: 999999, price: 2.00}
                    ],
                    '5.8" x 8.3"': [
                        {min: 10, max: 19, price: 8.25},
                        {min: 20, max: 49, price: 7.00},
                        {min: 50, max: 99, price: 5.00},
                        {min: 100, max: 199, price: 3.50},
                        {min: 200, max: 299, price: 3.00},
                        {min: 300, max: 499, price: 2.75},
                        {min: 500, max: 999, price: 2.50},
                        {min: 1000, max: 2499, price: 2.25},
                        {min: 2500, max: 4999, price: 2.25},
                        {min: 5000, max: 999999, price: 2.00}
                    ]
                }
            },
            large: {
                sizes: [
                    '8.3" x 11.7" (Safety Shirt FB)',
                    '11.7" x 4.25"',
                    '11.7" x 11.7" (FF or FB)',
                    '16.5" x 5.85"',
                    '11.7" x 16.5"'
                ],
                prices: {
                    '8.3" x 11.7" (Safety Shirt FB)': [
                        {min: 10, max: 19, price: 10.00},
                        {min: 20, max: 49, price: 8.25},
                        {min: 50, max: 99, price: 6.50},
                        {min: 100, max: 199, price: 4.50},
                        {min: 200, max: 299, price: 3.75},
                        {min: 300, max: 499, price: 3.50},
                        {min: 500, max: 999, price: 3.25},
                        {min: 1000, max: 2499, price: 3.00},
                        {min: 2500, max: 4999, price: 3.00},
                        {min: 5000, max: 999999, price: 2.75}
                    ],
                    '11.7" x 4.25"': [
                        {min: 10, max: 19, price: 8.25},
                        {min: 20, max: 49, price: 7.00},
                        {min: 50, max: 99, price: 5.00},
                        {min: 100, max: 199, price: 3.50},
                        {min: 200, max: 299, price: 3.00},
                        {min: 300, max: 499, price: 2.75},
                        {min: 500, max: 999, price: 2.50},
                        {min: 1000, max: 2499, price: 2.25},
                        {min: 2500, max: 4999, price: 2.25},
                        {min: 5000, max: 999999, price: 2.00}
                    ],
                    '11.7" x 11.7" (FF or FB)': [
                        {min: 10, max: 19, price: 12.50},
                        {min: 20, max: 49, price: 10.50},
                        {min: 50, max: 99, price: 8.25},
                        {min: 100, max: 199, price: 5.75},
                        {min: 200, max: 299, price: 4.75},
                        {min: 300, max: 499, price: 4.50},
                        {min: 500, max: 999, price: 4.25},
                        {min: 1000, max: 2499, price: 4.00},
                        {min: 2500, max: 4999, price: 3.75},
                        {min: 5000, max: 999999, price: 3.75}
                    ],
                    '16.5" x 5.85"': [
                        {min: 10, max: 19, price: 10.00},
                        {min: 20, max: 49, price: 8.25},
                        {min: 50, max: 99, price: 6.50},
                        {min: 100, max: 199, price: 4.50},
                        {min: 200, max: 299, price: 3.75},
                        {min: 300, max: 499, price: 3.50},
                        {min: 500, max: 999, price: 3.25},
                        {min: 1000, max: 2499, price: 3.00},
                        {min: 2500, max: 4999, price: 3.00},
                        {min: 5000, max: 999999, price: 2.75}
                    ],
                    '11.7" x 16.5"': [
                        {min: 10, max: 19, price: 15.00},
                        {min: 20, max: 49, price: 12.50},
                        {min: 50, max: 99, price: 10.00},
                        {min: 100, max: 199, price: 7.00},
                        {min: 200, max: 299, price: 6.00},
                        {min: 300, max: 499, price: 5.50},
                        {min: 500, max: 999, price: 5.25},
                        {min: 1000, max: 2499, price: 5.00},
                        {min: 2500, max: 4999, price: 4.75},
                        {min: 5000, max: 999999, price: 4.75}
                    ]
                }
            }
        };
// Initialize transfer sizes
        function updateTransferSizes(locationNum) {
            const category = document.getElementById(`category${locationNum}`).value;
            const sizeSelect = document.getElementById(`size${locationNum}`);
            
            sizeSelect.innerHTML = '';
            
            dtfPricingData[category].sizes.forEach(size => {
                const option = document.createElement('option');
                option.value = size;
                option.textContent = size;
                sizeSelect.appendChild(option);
            });
            
            // Set default selections
            if (locationNum === 1) {
                if (category === 'small') {
                    sizeSelect.value = '4" x 4" (Left Chest)';
                } else if (category === 'large') {
                    sizeSelect.value = '11.7" x 11.7" (FF or FB)';
                }
            } else if (locationNum === 2) {
                // For second location, default to full back
                if (category === 'large') {
                    sizeSelect.value = '11.7" x 11.7" (FF or FB)';
                }
            }
        }

        // Toggle second location
        function toggleSecondLocation() {
            if (!hasSecondLocation) {
                // Add second location
                const secondLocationHTML = `
                    <div class="transfer-location" id="location2">
                        <div class="location-header">
                            <div class="location-title">Location 2: Second Transfer</div>
                            <button class="remove-location-btn" onclick="toggleSecondLocation()">Remove</button>
                        </div>
                        
                        <div class="transfer-size-selector">
                            <label for="category2">Transfer Category</label>
                            <select id="category2" onchange="updateTransferSizes(2)">
                                <option value="small">Small Transfers (1.5" - 5.8")</option>
                                <option value="large" selected>Large Transfers (8.3" - 16.5")</option>
                            </select>
                        </div>

                        <div class="transfer-size-selector">
                            <label for="size2">Transfer Size</label>
                            <select id="size2">
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="quantity2">Quantity</label>
                            <input type="number" id="quantity2" min="1" placeholder="Same as Location 1" style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: var(--radius-sm); font-size: 1em;">
                            <div class="info-text" style="font-size: 0.85em; color: #777; margin-top: 5px; font-style: italic;">Leave blank to use same quantity as Location 1</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('locationsContainer').insertAdjacentHTML('beforeend', secondLocationHTML);
                document.getElementById('addLocationText').textContent = '- Remove Second Location';
                hasSecondLocation = true;
                
                // Initialize the second location
                updateTransferSizes(2);
                
                // Copy quantity from location 1 if it exists
                const qty1 = document.getElementById('quantity1').value;
                if (qty1) {
                    const qty2Field = document.getElementById('quantity2');
                    qty2Field.value = qty1; // Set the actual value to match location 1
                    qty2Field.placeholder = `Same as Location 1 (${qty1})`;
                }
            } else {
                // Remove second location
                document.getElementById('location2').remove();
                document.getElementById('addLocationText').textContent = '+ Add Second Location';
                hasSecondLocation = false;
            }
        }

        // Find price for a specific transfer size and quantity
        function findTransferPrice(category, size, quantity) {
            const priceTable = dtfPricingData[category].prices[size];
            
            for (let tier of priceTable) {
                if (quantity >= tier.min && quantity <= tier.max) {
                    return tier.price;
                }
            }
            
            return null;
        }

        // Get current pricing tier
        function getCurrentTier(quantity) {
            for (let tier of PRICING_TIERS) {
                if (quantity >= tier.min && quantity <= tier.max) {
                    return tier;
                }
            }
            return PRICING_TIERS[PRICING_TIERS.length - 1];
        }

        // Calculate tier price
        function calculateTierPrice(totalTransferCost, tierBaseQty, numTransfers) {
            const freightPerPiece = FREIGHT_COST / tierBaseQty;
            // Apply margin only to garment cost, not transfers (which already include margin)
            const garmentPriceWithMargin = garmentCost / MARGIN_DIVISOR;
            const laborCost = LABOR_COST_PER_TRANSFER * numTransfers;
            const finalPrice = garmentPriceWithMargin + totalTransferCost + freightPerPiece + laborCost;
            
            return finalPrice;
        }

        // Main calculation function
        function calculateDTFPrice() {
            if (!garmentCost || garmentCost === 0) {
                alert('Please wait for garment cost to load');
                return;
            }
            
            // Get primary location details
            const category1 = document.getElementById('category1').value;
            const size1 = document.getElementById('size1').value;
            const quantity1 = parseInt(document.getElementById('quantity1').value);
            
            if (!quantity1 || quantity1 < 1) {
                alert('Please enter a valid quantity for Location 1');
                return;
            }
            
            // Initialize transfer details
            let transfers = [{
                category: category1,
                size: size1,
                quantity: quantity1
            }];
            
            // Check for second location
            if (hasSecondLocation) {
                const quantity2 = parseInt(document.getElementById('quantity2').value) || quantity1;
                const category2 = document.getElementById('category2').value;
                const size2 = document.getElementById('size2').value;
                
                transfers.push({
                    category: category2,
                    size: size2,
                    quantity: quantity2
                });
            }
            
            // Use the primary quantity for tier determination
            const primaryQuantity = quantity1;
            const currentTier = getCurrentTier(primaryQuantity);
            
            // Calculate total transfer costs
            let totalTransferCost = 0;
            let transferDetails = [];
            
            transfers.forEach((transfer, index) => {
                // Use actual quantity to find the transfer price from the pricing table
                const transferPrice = findTransferPrice(transfer.category, transfer.size, transfer.quantity);
                
                if (!transferPrice) {
                    alert(`Price not found for ${transfer.size}`);
                    return;
                }
                
                totalTransferCost += transferPrice;
                transferDetails.push({
                    location: index + 1,
                    size: transfer.size,
                    price: transferPrice,
                    quantity: transfer.quantity
                });
            });
            
            // Calculate pricing
            let displayPricePerPiece;
            let totalPrice;
            let isLTM = false;
            
            if (currentTier.isLTM) {
                // Less than minimum - calculate base price at 24 pieces + LTM charge
                isLTM = true;
                
                const tier24 = PRICING_TIERS.find(t => t.min === 24);
                // Recalculate transfer cost at 24 quantity for LTM pricing
                let ltmTransferCost = 0;
                transfers.forEach((transfer) => {
                    const transferPrice = findTransferPrice(transfer.category, transfer.size, 24);
                    if (transferPrice) {
                        ltmTransferCost += transferPrice;
                    }
                });
                const basePrice = calculateTierPrice(ltmTransferCost, tier24.baseQty, transfers.length);
                
                // Add LTM charge per piece
                const ltmPerPiece = MINIMUM_CHARGE / primaryQuantity;
                displayPricePerPiece = basePrice + ltmPerPiece;
                totalPrice = displayPricePerPiece * primaryQuantity;
            } else {
                // Calculate based on tier's base quantity
                displayPricePerPiece = calculateTierPrice(totalTransferCost, currentTier.baseQty, transfers.length);
                totalPrice = displayPricePerPiece * primaryQuantity;
            }
            
            // Calculate component costs for display
            const freightPerPiece = FREIGHT_COST / (currentTier.baseQty || primaryQuantity);
            const laborCostTotal = LABOR_COST_PER_TRANSFER * transfers.length;
            const garmentPriceWithMargin = garmentCost / MARGIN_DIVISOR;
            
            // Update result display
            updatePricingDisplay({
                displayPricePerPiece,
                totalPrice,
                isLTM,
                currentTier,
                transferDetails,
                garmentCost,
                garmentPriceWithMargin,
                totalTransferCost,
                freightPerPiece,
                laborCostTotal,
                primaryQuantity
            });
            
            // Show tier pricing comparison
            showTierPricing(transfers, currentTier);
            
            // Show results section
            document.getElementById('pricing-results').style.display = 'block';
        }

        // Store style number globally
        let currentStyleNumber = '';
        
        // Update pricing display
        function updatePricingDisplay(data) {
            const breakdownDiv = document.getElementById('breakdown-details');
            let breakdownHTML = '';
            
            if (data.isLTM) {
                const ltmPerPiece = MINIMUM_CHARGE / data.primaryQuantity;
                breakdownHTML += `
                    <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                        <strong style="color: #856404;">Less Than Minimum Order</strong><br>
                        <span style="color: #856404;">Orders under ${MINIMUM_CHARGE_QTY} pieces include a $${MINIMUM_CHARGE.toFixed(2)} setup charge</span><br>
                        <span style="color: #856404; font-size: 0.9em;">($${ltmPerPiece.toFixed(2)} per item for ${data.primaryQuantity} items ordered)</span>
                    </div>
                `;
            }
            
            // Use style number if available
            const styleLabel = currentStyleNumber ?
                `${currentStyleNumber} (Blank Cost) $${data.garmentCost.toFixed(2)}` :
                `Blank Garment $${data.garmentCost.toFixed(2)}`;
            
            breakdownHTML += `
                <div class="breakdown-item" style="font-style: italic; color: #666;">
                    <span class="breakdown-label">${styleLabel}</span>
                    <span class="breakdown-value"></span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">Garment with 40% margin</span>
                    <span class="breakdown-value">$${data.garmentPriceWithMargin.toFixed(2)}</span>
                </div>
            `;
            
            // Show transfer costs
            if (data.transferDetails.length > 1) {
                data.transferDetails.forEach(detail => {
                    breakdownHTML += `
                        <div class="breakdown-item indented">
                            <span class="breakdown-label" style="padding-left: 20px;">Location ${detail.location}: ${detail.size}</span>
                            <span class="breakdown-value">$${detail.price.toFixed(2)}</span>
                        </div>
                    `;
                });
                breakdownHTML += `
                    <div class="breakdown-item" style="font-weight: 600;">
                        <span>Total Transfer Cost</span>
                        <span>$${data.totalTransferCost.toFixed(2)}</span>
                    </div>
                `;
            } else {
                breakdownHTML += `
                    <div class="breakdown-item indented">
                        <span class="breakdown-label" style="padding-left: 20px;">${data.transferDetails[0].size} Transfer</span>
                        <span class="breakdown-value">$${data.transferDetails[0].price.toFixed(2)}</span>
                    </div>
                `;
            }
            
            breakdownHTML += `
                <div class="breakdown-item" style="margin-top: 10px;">
                    <span class="breakdown-label">Freight ($${FREIGHT_COST}÷${data.currentTier.baseQty || data.primaryQuantity})</span>
                    <span class="breakdown-value">$${data.freightPerPiece.toFixed(2)}</span>
                </div>
            `;
            
            // Enhanced labor breakdown
            breakdownHTML += `
                <div class="breakdown-item" style="margin-top: 10px;">
                    <span class="breakdown-label" style="font-weight: 600;">Labor Breakdown:</span>
                    <span></span>
                </div>
            `;
            
            data.transferDetails.forEach(detail => {
                const locationName = detail.location === 1 ? 'Front' : 'Back';
                breakdownHTML += `
                    <div class="breakdown-item sub-item">
                        <span class="breakdown-label" style="padding-left: 40px;">Labor - ${locationName} (${detail.size})</span>
                        <span class="breakdown-value">$${LABOR_COST_PER_TRANSFER.toFixed(2)}</span>
                    </div>
                `;
            });
            
            breakdownHTML += `
                <div class="breakdown-item indented" style="font-weight: 600;">
                    <span class="breakdown-label" style="padding-left: 20px;">Total Labor</span>
                    <span class="breakdown-value">$${data.laborCostTotal.toFixed(2)}</span>
                </div>
            `;
            
            if (data.isLTM) {
                const ltmPerPiece = MINIMUM_CHARGE / data.primaryQuantity;
                breakdownHTML += `
                    <div class="breakdown-item" style="margin-top: 10px;">
                        <span class="breakdown-label">LTM Charge ($${MINIMUM_CHARGE.toFixed(2)}÷${data.primaryQuantity})</span>
                        <span class="breakdown-value">$${ltmPerPiece.toFixed(2)}</span>
                    </div>
                `;
            }
            
            breakdownHTML += `
                <div class="breakdown-total">
                    <span>Price per Piece</span>
                    <span>$${data.displayPricePerPiece.toFixed(2)}</span>
                </div>
                
                <div style="text-align: center; margin-top: 20px; padding: 15px; background-color: #e8f5e9; border-radius: 8px;">
                    <div style="font-size: 1.8em; font-weight: 700; color: var(--primary-color);">
                        Total: $${data.totalPrice.toFixed(2)}
                    </div>
                    <div style="color: #666; margin-top: 5px;">
                        for ${data.primaryQuantity} pieces
                    </div>
                </div>
            `;
            
            breakdownDiv.innerHTML = breakdownHTML;
        }

        // Show tier pricing comparison
        function showTierPricing(transfers, currentTier) {
            const tierDiv = document.getElementById('tier-pricing-display');
            const numTransfers = transfers.length;
            const transfersText = numTransfers > 1 ? `${numTransfers} Transfers` : '1 Transfer';
            
            let tierHTML = `
                <div class="tier-pricing-title">📊 All Pricing Tiers (${transfersText})</div>
                <div class="tier-grid">
            `;
            
            PRICING_TIERS.forEach(tier => {
                // Calculate transfer cost for this tier's typical quantity
                let tierTransferCost = 0;
                const tierQty = tier.isLTM ? 24 : tier.baseQty || tier.min;
                
                // Get transfer prices for this tier quantity
                transfers.forEach((transfer, index) => {
                    const category = index === 0 ? document.getElementById('category1').value : document.getElementById('category2').value;
                    const size = index === 0 ? document.getElementById('size1').value : document.getElementById('size2').value;
                    const transferPrice = findTransferPrice(category, size, tierQty);
                    if (transferPrice) {
                        tierTransferCost += transferPrice;
                    }
                });
                
                if (tier.isLTM) {
                    // For LTM, show base price + LTM note
                    const tier24 = PRICING_TIERS.find(t => t.min === 24);
                    const basePrice = calculateTierPrice(tierTransferCost, tier24.baseQty, numTransfers);
                    
                    tierHTML += `
                        <div class="tier-card ${currentTier === tier ? 'current' : ''}" style="position: relative;">
                            <div class="tier-qty">${tier.label}</div>
                            <div class="tier-price">$${basePrice.toFixed(2)}</div>
                            <div class="tier-note" style="color: #dc3545; font-weight: 600;">+ $50 LTM</div>
                            <div style="font-size: 0.75em; color: #666; margin-top: 3px;">Total varies by qty</div>
                        </div>
                    `;
                } else {
                    const tierPrice = calculateTierPrice(tierTransferCost, tier.baseQty, numTransfers);
                    
                    tierHTML += `
                        <div class="tier-card ${currentTier === tier ? 'current' : ''}">
                            <div class="tier-qty">${tier.label} pieces</div>
                            <div class="tier-price">$${tierPrice.toFixed(2)}</div>
                            <div class="tier-note">per shirt</div>
                        </div>
                    `;
                }
            });
            
            tierHTML += '</div>';
            tierDiv.innerHTML = tierHTML;
        }

        // Function to fetch garment prices from API
        async function fetchGarmentPrices(styleNumber) {
            try {
                const response = await fetch(`https://caspio-pricing-proxy-ab30a049961a.herokuapp.com/api/max-prices-by-style?styleNumber=${styleNumber}`);
                if (!response.ok) {
                    throw new Error('Failed to fetch garment prices');
                }
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('[DTF] Error fetching garment prices:', error);
                return null;
            }
        }

        // Store size upcharges globally
        let sizeUpcharges = {};

        // Function to get base garment cost (lowest price, typically S-XL)
        function getBaseGarmentCost(priceData) {
            if (!priceData || !priceData.sizes || priceData.sizes.length === 0) {
                return 5.50; // Default fallback
            }
            
            // Find the lowest price (typically S-XL)
            const lowestPrice = Math.min(...priceData.sizes.map(size => size.price));
            
            // Store upcharges for later use
            if (priceData.sellingPriceDisplayAddOns) {
                sizeUpcharges = priceData.sellingPriceDisplayAddOns;
            }
            
            return lowestPrice;
        }

        // Listen for product data loaded event
        window.addEventListener('productColorsReady', async function(event) {
            console.log('[DTF] Product colors ready:', event.detail);
            
            // Get style number from URL or event
            const urlParams = new URLSearchParams(window.location.search);
            const styleNumber = urlParams.get('StyleNumber') || (event.detail && event.detail.styleNumber);
            
            if (styleNumber) {
                // Store the style number globally
                currentStyleNumber = styleNumber;
                
                // Fetch garment prices from API
                const priceData = await fetchGarmentPrices(styleNumber);
                
                if (priceData) {
                    // Get base garment cost (lowest price, typically S-XL)
                    garmentCost = getBaseGarmentCost(priceData);
                    
                    // Log the price breakdown for transparency
                    console.log('[DTF] Style Number:', currentStyleNumber);
                    console.log('[DTF] Garment prices by size:', priceData.sizes);
                    console.log('[DTF] Size upcharges:', sizeUpcharges);
                    console.log('[DTF] Base garment cost:', garmentCost);
                } else {
                    // Fallback to default if API fails
                    garmentCost = 5.50;
                    console.log('[DTF] Using default garment cost (API unavailable)');
                }
            } else {
                // No style number available
                garmentCost = 5.50;
                console.log('[DTF] Using default garment cost (no style specified)');
            }
        });

        // Toggle accordion function
        function toggleAccordion() {
            const accordion = document.getElementById('pricing-formula-accordion');
            accordion.classList.toggle('active');
        }
        
        // Toggle pricing breakdown accordion
        function togglePricingBreakdown() {
            const accordion = document.getElementById('pricing-breakdown-accordion');
            
            // Check if password protection is enabled (can be set via data attribute)
            const requirePassword = accordion.dataset.requirePassword === 'true';
            
            if (requirePassword && !accordion.classList.contains('active')) {
                // Simple password check - you can customize this
                const password = prompt('Enter password to view cost analysis:');
                if (password !== 'nwca2025') { // Change this password as needed
                    alert('Incorrect password');
                    return;
                }
            }
            
            accordion.classList.toggle('active');
        }
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            updateTransferSizes(1);
            
            // Sync quantity fields when first location quantity changes
            document.getElementById('quantity1').addEventListener('input', function() {
                if (hasSecondLocation) {
                    const qty2Field = document.getElementById('quantity2');
                    // Always update the value to match location 1, unless user has manually entered a different value
                    qty2Field.value = this.value;
                    qty2Field.placeholder = `Same as Location 1 (${this.value})`;
                }
            });
            
            // Initialize DTF-specific globals to prevent errors
            window.dtfPricingInitialized = true;
            
            // Dispatch event to signal DTF page is ready
            window.dispatchEvent(new CustomEvent('dtfPageReady', {
                detail: {
                    styleNumber: currentStyleNumber || 'PC61',
                    embellishmentType: 'dtf'
                }
            }));
        });
        
        // Override the product pricing UI ready check for DTF
        window.addEventListener('nwcaProductPricingUIReady', function() {
            console.log('[DTF] Product pricing UI ready event received');
        });
        
        // Prevent errors from missing pricing matrix elements
        window.addEventListener('pricingDataLoaded', function(event) {
            console.log('[DTF] Pricing data loaded event received:', event.detail);
            // DTF page handles its own pricing, so we just acknowledge the event
        });
    </script>
</body>
</html>